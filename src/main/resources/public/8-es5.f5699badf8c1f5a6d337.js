function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{K1Id:function(e,t,i){"use strict";i.r(t),i.d(t,"TransactionModule",(function(){return ca}));var a,r=i("ofXK"),n=i("tyNb"),o=i("3Pt+"),c=i("Y7HM"),l=i("ro1u"),d=i("fXoL"),s=i("tk/3"),b=((a=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"save",value:function(e){return this.http.post("transaction/order",e)}},{key:"findAll",value:function(){return this.http.get("transaction/orders")}},{key:"findById",value:function(e){return this.http.get("transaction/orders/find",{params:{id:e}})}},{key:"delete",value:function(e){return this.http.delete("transaction/orders/delete",{params:{id:e}})}},{key:"deleteDetail",value:function(e,t){var i=new s.d;return i=(i=i.append("id",e)).append("detailId",t.toString()),this.http.delete("transaction/orders/detail/delete",{params:i})}},{key:"downloadInvoice",value:function(e){var t=this;this.http.get("transaction/orders/invoice",{responseType:"blob",params:{id:e}}).subscribe((function(e){return t.downloadFile(e)}),(function(e){return console.log("Error downloading the file.")}))}},{key:"downloadFile",value:function(e){new Blob([e],{type:"application/pdf"});var t=window.URL.createObjectURL(e),i=window.open(t);i&&!i.closed&&void 0!==i.closed||alert("Please disable your Pop-up blocker and try again.")}}]),e}()).\u0275fac=function(e){return new(e||a)(d.bc(s.b))},a.\u0275prov=d.Nb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),u=i("zYZu"),m=i("+hj4"),f=i("Deg8"),p=i("Ce0u"),h=i("ShJT"),v=i("0IaG"),g=i("NFeN"),W=i("kmnG"),X=i("qFsG"),y=i("d3UM"),I=i("iadO"),C=i("dbUT"),D=i("FKr1");function S(e,t){if(1&e&&(d.Xb(0,"div"),d.Xb(1,"p",6),d.Hc(2),d.Wb(),d.Wb()),2&e){var i=d.ic();d.Cb(2),d.Jc("Order Id : ",i.orderId,"")}}function k(e,t){1&e&&(d.Xb(0,"div"),d.Xb(1,"p",40),d.Hc(2,"Enter order placement details for raw materials"),d.Wb(),d.Wb())}function w(e,t){if(1&e&&(d.Xb(0,"mat-option",70),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.projectId),d.Cb(1),d.Kc(" ",i.projectId," | ",i.description," ")}}function M(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Project is required"),d.Wb())}function F(e,t){if(1&e&&(d.Xb(0,"mat-option",70),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.clientId),d.Cb(1),d.Jc(" ",i.clientName," ")}}function H(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Supplier is required"),d.Wb())}function N(e,t){if(1&e&&(d.Xb(0,"mat-option",70),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.detailId),d.Cb(1),d.Jc(" ",i.identifier," ")}}function x(e,t){if(1&e&&(d.Xb(0,"mat-option",70),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.value),d.Cb(1),d.Jc(" ",i.viewValue," ")}}function A(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Order date is required"),d.Wb())}function j(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Expected delivary date is required"),d.Wb())}function q(e,t){if(1&e&&(d.Xb(0,"mat-option",70),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.value),d.Cb(1),d.Jc(" ",i.viewValue," ")}}function G(e,t){if(1&e&&(d.Xb(0,"mat-option",70),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.value),d.Cb(1),d.Jc(" ",i.viewValue," ")}}function O(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Payment terms is required"),d.Wb())}function P(e,t){if(1&e){var i=d.Yb();d.Xb(0,"tbody"),d.Xb(1,"tr"),d.Xb(2,"td"),d.Hc(3),d.Wb(),d.Xb(4,"td"),d.Hc(5),d.Wb(),d.Xb(6,"td"),d.Hc(7),d.Wb(),d.Xb(8,"td"),d.Hc(9),d.Wb(),d.Xb(10,"td"),d.Hc(11),d.Wb(),d.Xb(12,"td"),d.Xb(13,"a",71),d.fc("click",(function(){d.Ac(i);var e=t.$implicit,a=d.ic(),r=d.xc(107);return a.editDetail(e,r)})),d.Xb(14,"mat-icon",72),d.Hc(15,"edit"),d.Wb(),d.Wb(),d.Xb(16,"a",73),d.fc("click",(function(){d.Ac(i);var e=t.$implicit;return d.ic().openDialog(e)})),d.Xb(17,"mat-icon",72),d.Hc(18,"delete"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=t.$implicit;d.Cb(3),d.Ic(a.rmName),d.Cb(2),d.Ic(a.quantity),d.Cb(2),d.Ic(a.unitId),d.Cb(2),d.Ic(a.rate),d.Cb(2),d.Ic(a.amount)}}function E(e,t){if(1&e){var i=d.Yb();d.Xb(0,"mat-option",74),d.fc("onSelectionChange",(function(){d.Ac(i);var e=t.$implicit;return d.ic().populateUnit(e)})),d.Hc(1),d.Wb()}if(2&e){var a=t.$implicit;d.oc("value",a.code),d.Cb(1),d.Jc(" ",a.name," ")}}function R(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Raw material is required"),d.Wb())}function T(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Unit is required"),d.Wb())}function U(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Quantity is required"),d.Wb())}function B(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Rate is required "),d.Wb())}function L(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Amount is required "),d.Wb())}var V,Q=((V=function(){function e(t,i,a,r,n,o,c,l,d){var s=this;_classCallCheck(this,e),this.orderPlacementService=t,this.notificationService=i,this.rawMaterialService=a,this.clientService=r,this.projectService=n,this.unitService=o,this.dialog=c,this.route=l,this.datePipe=d,this.details=[],this.displayedColumns=["rmId","quantity","unitId"],this.rawMaterials=[],this.suppliers=[],this.projects=[],this.units=[],this.supplierDetails=[],this.statusValues=[{value:"draft",viewValue:"Draft"},{value:"in_progress",viewValue:"In Progress"},{value:"submit",viewValue:"Submit"}],this.workUnits=[{value:"DUMDUM",viewValue:"Dum dum unit"},{value:"SINGUR",viewValue:"Singur Unit"}],this.freightCharges=[{value:"Inclusive",viewValue:"Inclusive"},{value:"Exclisive",viewValue:"Exclisive"}],this.hasError=function(e,t){return s.opForm.controls[e].hasError(t)},this.hasDetailError=function(e,t){return s.opDetailForm.controls[e].hasError(t)}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.getRawMaterials(),this.getSuppliers(),this.getProjects(),this.getUnits(),this.opForm=new o.e({orderId:new o.c(""),supplierId:new o.c(""),supplierDetailsId:new o.c(""),expectedDeliveryDate:new o.c(null,o.o.required),status:new o.c("",o.o.required),notes:new o.c(""),projectId:new o.c("",o.o.required),description:new o.c(""),identifier:new o.c(""),siteId:new o.c("",o.o.required),details:new o.c(""),expectedDeliveryDateString:new o.c(""),isActive:new o.c(""),supplierName:new o.c(""),orderDate:new o.c(new Date,o.o.required),orderDateString:new o.c(""),freightChargeType:new o.c(""),paymentTerms:new o.c("Against Delivery else @ 18% interest from the date of delivery",o.o.required)}),this.opDetailForm=new o.e({orderId:new o.c(""),orderDetailsId:new o.c(""),rmId:new o.c("",o.o.required),rmName:new o.c(""),unitId:new o.c(""),unitName:new o.c("",o.o.required),quantity:new o.c(0,o.o.required),rate:new o.c(0,o.o.required),amount:new o.c(0,o.o.required),alreadyOrderedQuantity:new o.c(null),remainingQuantity:new o.c(null)}),this.route.queryParams.subscribe((function(t){Object.keys(t).length>0&&e.orderPlacementService.findById(t.id).subscribe((function(t){e.details=t.details,t.expectedDeliveryDate=e.convertToDate(t.expectedDeliveryDateString),t.orderDate=e.convertToDate(t.orderDateString),e.filterSupplierDateils(t.supplierId),e.opForm.setValue(t),e.orderId=t.orderId}))}))}},{key:"convertToDate",value:function(e){var t=null;return null!=e&&e.length>0&&(t=new Date(e)),t}},{key:"onSubmit",value:function(){var e=this;this.opForm.valid&&(this.orderPlacement=this.opForm.value,this.orderPlacement.details=this.details,null!=this.opForm.value.isActive&&""!=this.opForm.value.isActive||(this.orderPlacement.isActive=!0),this.orderPlacement.expectedDeliveryDateString=this.datePipe.transform(this.orderPlacement.expectedDeliveryDate,"dd/MM/yyyy"),this.orderPlacement.orderDateString=this.datePipe.transform(this.orderPlacement.orderDate,"dd/MM/yyyy"),this.orderPlacementService.save(this.orderPlacement).subscribe((function(t){e.notificationService.openSnackBar(t.message,t.status),console.log("success response ::"),console.log(t),e.opForm.reset(),e.details=[]}),(function(t){e.notificationService.openSnackBar(t.error.message,t.error.status),console.log("error response ::"),console.log(t.message)})))}},{key:"onDetailSubmit",value:function(e){if(this.opDetailForm.valid){var t,i=this.opDetailForm.value,a=i.orderId;t=this.details.findIndex(null!=a&&a.length>0?function(e){return e.orderId==a}:function(e){return e.rmId==i.rmId}),console.log("last index >>"+t),-1!=t?(this.details[t]=this.opDetailForm.value,this.notificationService.openSnackBar("Log updated successfully","success")):(this.details.push(this.opDetailForm.value),this.notificationService.openSnackBar("Log added successfully","success")),this.opDetailForm.reset(),e.hide()}else this.notificationService.openSnackBar("Error occurred, please review and submit again","danger")}},{key:"getRawMaterials",value:function(){var e=this;this.rawMaterialService.findAllRawMaterials().subscribe((function(t){e.rawMaterials=t}))}},{key:"getSuppliers",value:function(){var e=this;this.clientService.findAll().subscribe((function(t){e.suppliers=t}))}},{key:"getProjects",value:function(){var e=this;this.projectService.findAll().subscribe((function(t){e.projects=t}))}},{key:"getUnits",value:function(){var e=this;this.unitService.getAllUnits().subscribe((function(t){e.units=t}))}},{key:"close",value:function(e){e.hide()}},{key:"populateUnit",value:function(e){this.rmName=e.name,this.unitId=e.unit.unitId,this.unitName=e.unit.unitName}},{key:"editDetail",value:function(e,t){this.opDetailForm.setValue(e),t.show()}},{key:"openDialog",value:function(e){var t=this;this.dialog.open(l.a,{width:"250px",data:{header:"Confirm",content:"Are you sure to delete?"}}).afterClosed().subscribe((function(i){i&&t.deleteDetail(e)}))}},{key:"deleteDetail",value:function(e){var t=this,i=this.calculateDetailIndex(e);e.orderId?this.orderPlacementService.deleteDetail(e.orderId,e.orderDetailsId).subscribe((function(e){t.details.splice(i,1),t.notificationService.openSnackBar(e.message,e.status)}),(function(e){t.notificationService.openSnackBar(e.error.message,e.error.status),console.log("error response ::"),console.log(e.message)})):-1!==i&&(this.details.splice(i,1),this.notificationService.openSnackBar("Order details removed successfully","success"))}},{key:"calculateDetailIndex",value:function(e){return this.details.findIndex(null!=e.orderId&&e.orderId.length>0?function(t){return t.orderId==e.orderId}:function(t){return t.rmId==e.rmId})}},{key:"populateSupplierDetails",value:function(e){this.filterSupplierDateils(e.value)}},{key:"filterSupplierDateils",value:function(e){this.supplierDetails=this.suppliers.filter((function(t){return t.clientId===e}))[0].details}},{key:"calculateDetail",value:function(){var e=this.opDetailForm.value.quantity,t=this.opDetailForm.value.rate;Object(c.a)(e)&&Object(c.a)(t)&&(this.detailAmount=(Number.parseFloat(t.toString())*Number.parseFloat(e.toString())).toFixed(2))}},{key:"isMobileMenu",value:function(){return!($(window).width()>991)}},{key:"modalWIdth",value:function(){return this.isMobileMenu()?"100%":"150%"}}]),e}()).\u0275fac=function(e){return new(e||V)(d.Rb(b),d.Rb(u.a),d.Rb(m.a),d.Rb(f.a),d.Rb(p.a),d.Rb(h.a),d.Rb(v.b),d.Rb(n.a),d.Rb(r.d))},V.\u0275cmp=d.Lb({type:V,selectors:[["app-order-placement"]],decls:152,vars:35,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header","card-header-success"],[1,"card-title"],["routerLink","/transaction/orders"],["alt","Show All",1,"gridIcon"],[4,"ngIf"],[1,"card-body"],[3,"formGroup","ngSubmit"],["headerForm","ngForm"],[1,"col-md-3"],[1,"invisible","example-full-width"],["matInput","","placeholder","orderId","formControlName","orderId"],["matInput","","placeholder","isActive","formControlName","isActive"],[1,"example-full-width"],["placeholder","Project","formControlName","projectId"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-2"],["placeholder","Supplier","formControlName","supplierId",3,"selectionChange"],["placeholder","Supplier Address","formControlName","supplierDetailsId"],["placeholder","Work Unit","formControlName","siteId"],["matInput","","formControlName","orderDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker3",""],["matInput","","formControlName","expectedDeliveryDate",3,"matDatepicker"],["picker1",""],["placeholder","Status","formControlName","status"],["placeholder","Freight Charges","formControlName","freightChargeType"],[1,"col-md-6"],["matInput","","placeholder","Payment Terms","formControlName","paymentTerms"],["matInput","","placeholder","Notes","formControlName","notes"],[1,"card","card-plain"],[1,"card-header","card-header-info"],["width","100%"],["width","90%"],[2,"align-content","justify-content-right"],["type","button","mdbBtn","","color","unique","rounded","true","data-toggle","modal","data-target","#basicExample","mdbWavesEffect","",3,"click"],[1,"card-category"],[1,"table-responsive"],[1,"table","table-hover"],[1,"text-primary"],[4,"ngFor","ngForOf"],["mat-raised-button","","type","submit",1,"btn","btn-success","pull-right",3,"disabled","click"],[1,"clearfix"],["mdbModal","","id","frameModalTop","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade","left"],["frame","mdbModal"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","text-center"],[1,"modal-title","w-100","font-weight-bold"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[3,"formGroup"],[1,"col-md-4"],["matInput","","placeholder","orderDetailsId","formControlName","orderDetailsId"],["matInput","","placeholder","alreadyOrderedQuantity","formControlName","alreadyOrderedQuantity"],["matInput","","placeholder","remainingQuantity","formControlName","remainingQuantity"],["matInput","","formControlName","rmName",3,"ngModel","ngModelChange"],["placeholder","Raw Material","formControlName","rmId"],[3,"value","onSelectionChange",4,"ngFor","ngForOf"],["matInput","","placeholder","Unit","formControlName","unitId",3,"ngModel","ngModelChange"],["matInput","","placeholder","Unit","formControlName","unitName",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","Quantity","formControlName","quantity",3,"change"],["matInput","","placeholder","Rate","formControlName","rate",2,"text-align","right",3,"change"],["matInput","","placeholder","Amount","formControlName","amount",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],[1,"modal-footer","d-flex","justify-content-right"],["mdbBtn","","color","deep-orange","mdbWavesEffect","",1,"waves-light",3,"click"],[3,"value"],["title","","data-toggle","tooltip","data-original-title","Edit",1,"edit",2,"cursor","pointer",3,"click"],[1,"routeIcon"],["title","","data-toggle","tooltip","data-original-title","Delete",1,"delete",2,"cursor","pointer",3,"click"],[3,"value","onSelectionChange"]],template:function(e,t){if(1&e){var i=d.Yb();d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Raw material order placement "),d.Xb(8,"a",7),d.Xb(9,"mat-icon",8),d.Hc(10,"web"),d.Wb(),d.Wb(),d.Wb(),d.Gc(11,S,3,1,"div",9),d.Gc(12,k,3,0,"div",9),d.Wb(),d.Xb(13,"div",10),d.Xb(14,"form",11,12),d.fc("ngSubmit",(function(){return t.onSubmit()})),d.Xb(16,"div",2),d.Xb(17,"div",13),d.Xb(18,"mat-form-field",14),d.Sb(19,"input",15),d.Sb(20,"input",16),d.Wb(),d.Xb(21,"mat-form-field",17),d.Xb(22,"mat-select",18),d.Gc(23,w,2,3,"mat-option",19),d.Wb(),d.Gc(24,M,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(25,"div",20),d.Xb(26,"mat-form-field",17),d.Xb(27,"mat-select",21),d.fc("selectionChange",(function(e){return t.populateSupplierDetails(e)})),d.Gc(28,F,2,2,"mat-option",19),d.Wb(),d.Gc(29,H,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(30,"div",13),d.Xb(31,"mat-form-field",17),d.Xb(32,"mat-select",22),d.Gc(33,N,2,2,"mat-option",19),d.Wb(),d.Wb(),d.Wb(),d.Xb(34,"div",20),d.Xb(35,"mat-form-field",17),d.Xb(36,"mat-select",23),d.Gc(37,x,2,2,"mat-option",19),d.Wb(),d.Wb(),d.Wb(),d.Xb(38,"div",20),d.Xb(39,"mat-form-field"),d.Xb(40,"mat-label"),d.Hc(41,"Order Date"),d.Wb(),d.Sb(42,"input",24),d.Sb(43,"mat-datepicker-toggle",25),d.Sb(44,"mat-datepicker",null,26),d.Gc(46,A,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Wb(),d.Xb(47,"div",2),d.Xb(48,"div",20),d.Xb(49,"mat-form-field"),d.Xb(50,"mat-label"),d.Hc(51,"Expected Delivary Date"),d.Wb(),d.Sb(52,"input",27),d.Sb(53,"mat-datepicker-toggle",25),d.Sb(54,"mat-datepicker",null,28),d.Gc(56,j,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(57,"div",20),d.Xb(58,"mat-form-field",17),d.Xb(59,"mat-select",29),d.Gc(60,q,2,2,"mat-option",19),d.Wb(),d.Wb(),d.Wb(),d.Xb(61,"div",20),d.Xb(62,"mat-form-field",17),d.Xb(63,"mat-select",30),d.Gc(64,G,2,2,"mat-option",19),d.Wb(),d.Wb(),d.Wb(),d.Xb(65,"div",31),d.Xb(66,"mat-form-field",17),d.Sb(67,"input",32),d.Gc(68,O,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Wb(),d.Xb(69,"div",2),d.Xb(70,"div",3),d.Xb(71,"mat-form-field",17),d.Sb(72,"input",33),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(73,"div",2),d.Xb(74,"div",3),d.Xb(75,"div",34),d.Xb(76,"div",35),d.Xb(77,"table",36),d.Xb(78,"tr"),d.Xb(79,"td",37),d.Xb(80,"h4",6),d.Hc(81,"Order Placement Dteails"),d.Wb(),d.Wb(),d.Xb(82,"td",38),d.Xb(83,"button",39),d.fc("click",(function(){return d.Ac(i),d.xc(107).show()})),d.Hc(84," Add "),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Sb(85,"p",40),d.Wb(),d.Xb(86,"div",10),d.Xb(87,"div",41),d.Xb(88,"table",42),d.Xb(89,"thead",43),d.Xb(90,"th"),d.Hc(91,"Raw Material"),d.Wb(),d.Xb(92,"th"),d.Hc(93,"Quantity"),d.Wb(),d.Xb(94,"th"),d.Hc(95,"Unit"),d.Wb(),d.Xb(96,"th"),d.Hc(97,"Rate"),d.Wb(),d.Xb(98,"th"),d.Hc(99,"Amount"),d.Wb(),d.Xb(100,"th"),d.Hc(101,"Action"),d.Wb(),d.Wb(),d.Gc(102,P,19,5,"tbody",44),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(103,"button",45),d.fc("click",(function(){return d.Ac(i),d.xc(15).ngSubmit.emit()})),d.Hc(104,"Save"),d.Wb(),d.Sb(105,"div",46),d.Xb(106,"div",47,48),d.Xb(108,"div",49),d.Xb(109,"div",50),d.Xb(110,"div",51),d.Xb(111,"h4",52),d.Hc(112,"Order Placement Details"),d.Wb(),d.Xb(113,"button",53),d.fc("click",(function(){d.Ac(i);var e=d.xc(107);return t.close(e)})),d.Xb(114,"span",54),d.Hc(115,"\xd7"),d.Wb(),d.Wb(),d.Wb(),d.Xb(116,"div",10),d.Xb(117,"form",55),d.Xb(118,"div",2),d.Xb(119,"div",56),d.Xb(120,"mat-form-field",14),d.Sb(121,"input",15),d.Sb(122,"input",57),d.Sb(123,"input",58),d.Sb(124,"input",59),d.Wb(),d.Xb(125,"mat-form-field",14),d.Xb(126,"input",60),d.fc("ngModelChange",(function(e){return t.rmName=e})),d.Wb(),d.Wb(),d.Xb(127,"mat-form-field",17),d.Xb(128,"mat-select",61),d.Gc(129,E,2,2,"mat-option",62),d.Wb(),d.Gc(130,R,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(131,"div",20),d.Xb(132,"mat-form-field",14),d.Xb(133,"input",63),d.fc("ngModelChange",(function(e){return t.unitId=e})),d.Wb(),d.Wb(),d.Xb(134,"mat-form-field",17),d.Xb(135,"input",64),d.fc("ngModelChange",(function(e){return t.unitName=e})),d.Wb(),d.Gc(136,T,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(137,"div",20),d.Xb(138,"mat-form-field",17),d.Xb(139,"input",65),d.fc("change",(function(){return t.calculateDetail()})),d.Wb(),d.Gc(140,U,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(141,"div",20),d.Xb(142,"mat-form-field",17),d.Xb(143,"input",66),d.fc("change",(function(){return t.calculateDetail()})),d.Wb(),d.Gc(144,B,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(145,"div",20),d.Xb(146,"mat-form-field",17),d.Xb(147,"input",67),d.fc("ngModelChange",(function(e){return t.detailAmount=e})),d.Wb(),d.Gc(148,L,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Wb(),d.Xb(149,"div",68),d.Xb(150,"button",69),d.fc("click",(function(){d.Ac(i);var e=d.xc(107);return t.onDetailSubmit(e)})),d.Hc(151,"Save"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=d.xc(15),r=d.xc(45),n=d.xc(55);d.Cb(11),d.oc("ngIf",t.orderId),d.Cb(1),d.oc("ngIf",!t.orderId),d.Cb(2),d.oc("formGroup",t.opForm),d.Cb(9),d.oc("ngForOf",t.projects),d.Cb(1),d.oc("ngIf",t.hasError("projectId","required")),d.Cb(4),d.oc("ngForOf",t.suppliers),d.Cb(1),d.oc("ngIf",t.hasError("supplierId","required")),d.Cb(4),d.oc("ngForOf",t.supplierDetails),d.Cb(4),d.oc("ngForOf",t.workUnits),d.Cb(5),d.oc("matDatepicker",r),d.Cb(1),d.oc("for",r),d.Cb(3),d.oc("ngIf",t.hasError("expectedDeliveryDate","required")),d.Cb(6),d.oc("matDatepicker",n),d.Cb(1),d.oc("for",n),d.Cb(3),d.oc("ngIf",t.hasError("expectedDeliveryDate","required")),d.Cb(4),d.oc("ngForOf",t.statusValues),d.Cb(4),d.oc("ngForOf",t.freightCharges),d.Cb(4),d.oc("ngIf",t.hasError("paymentTerms","required")),d.Cb(34),d.oc("ngForOf",t.details),d.Cb(1),d.oc("disabled",!a.form.valid),d.Cb(6),d.Fc("width",t.modalWIdth()),d.Cb(8),d.oc("formGroup",t.opDetailForm),d.Cb(9),d.oc("ngModel",t.rmName),d.Cb(3),d.oc("ngForOf",t.rawMaterials),d.Cb(1),d.oc("ngIf",t.hasDetailError("rmId","required")),d.Cb(3),d.oc("ngModel",t.unitId),d.Cb(2),d.oc("readonly",!0)("ngModel",t.unitName),d.Cb(1),d.oc("ngIf",t.hasDetailError("unitName","required")),d.Cb(4),d.oc("ngIf",t.hasDetailError("quantity","required")),d.Cb(4),d.oc("ngIf",t.hasDetailError("rate","required")),d.Cb(3),d.oc("readonly",!0)("ngModel",t.detailAmount),d.Cb(1),d.oc("ngIf",t.hasDetailError("amount","required"))}},directives:[n.e,g.a,r.l,o.p,o.l,o.f,W.c,X.b,o.a,o.k,o.d,y.a,r.k,W.f,I.b,I.d,W.g,I.a,C.b,C.c,D.l,W.b],styles:[""]}),V);function _(e,t){1&e&&(d.Xb(0,"th"),d.Hc(1,"Estimated delivery date"),d.Wb())}function J(e,t){1&e&&(d.Xb(0,"th"),d.Hc(1,"Status"),d.Wb())}function Y(e,t){if(1&e&&(d.Xb(0,"td"),d.Hc(1),d.Wb()),2&e){var i=d.ic().$implicit;d.Cb(1),d.Ic(i.expectedDeliveryDateString)}}function K(e,t){if(1&e&&(d.Xb(0,"td"),d.Hc(1),d.Wb()),2&e){var i=d.ic().$implicit;d.Cb(1),d.Ic(i.status)}}var z=function(){return["/transaction/orders/edit"]},Z=function(e){return{id:e}};function ee(e,t){if(1&e){var i=d.Yb();d.Xb(0,"tbody"),d.Xb(1,"tr"),d.Xb(2,"td"),d.Hc(3),d.Wb(),d.Xb(4,"td"),d.Hc(5),d.Wb(),d.Xb(6,"td"),d.Hc(7),d.Wb(),d.Gc(8,Y,2,1,"td",14),d.Gc(9,K,2,1,"td",14),d.Xb(10,"td"),d.Xb(11,"a",16),d.fc("click",(function(){d.Ac(i);var e=t.$implicit;return d.ic().downloadInvoice(e.orderId)})),d.Xb(12,"mat-icon",17),d.Hc(13,"save_alt"),d.Wb(),d.Wb(),d.Xb(14,"a",18),d.Xb(15,"mat-icon",17),d.Hc(16,"edit"),d.Wb(),d.Wb(),d.Xb(17,"a",19),d.fc("click",(function(){d.Ac(i);var e=t.$implicit;return d.ic().openDialog(e)})),d.Xb(18,"mat-icon",17),d.Hc(19,"delete"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=t.$implicit,r=d.ic();d.Cb(3),d.Ic(a.orderId),d.Cb(2),d.Ic(a.projectId),d.Cb(2),d.Ic(a.supplierName),d.Cb(1),d.oc("ngIf",!r.isMobileMenu()),d.Cb(1),d.oc("ngIf",!r.isMobileMenu()),d.Cb(5),d.oc("routerLink",d.qc(7,z))("queryParams",d.rc(8,Z,a.orderId))}}var te,ie=((te=function(){function e(t,i,a){_classCallCheck(this,e),this.orderPlacementService=t,this.notificationService=i,this.dialog=a,this.orders=[]}return _createClass(e,[{key:"ngOnInit",value:function(){this.findAll()}},{key:"findAll",value:function(){var e=this;this.orderPlacementService.findAll().subscribe((function(t){e.orders=t}))}},{key:"delete",value:function(e){var t=this;this.orderPlacementService.delete(e.orderId).subscribe((function(e){console.log("Delete Response >>>>"),console.log(e),t.notificationService.openSnackBar(e.message,e.status),t.findAll()}))}},{key:"openDialog",value:function(e){var t=this;this.dialog.open(l.a,{width:"250px",data:{header:"Confirm",content:"Are you sure to delete?"}}).afterClosed().subscribe((function(i){i&&t.delete(e)}))}},{key:"isMobileMenu",value:function(){return!($(window).width()>991)}},{key:"downloadInvoice",value:function(e){this.orderPlacementService.downloadInvoice(e)}},{key:"downloadFile",value:function(e){var t=window.URL.createObjectURL(e),i=window.open(t);i&&!i.closed&&void 0!==i.closed||alert("Please disable your Pop-up blocker and try again.")}}]),e}()).\u0275fac=function(e){return new(e||te)(d.Rb(b),d.Rb(u.a),d.Rb(v.b))},te.\u0275cmp=d.Lb({type:te,selectors:[["app-order-placement-show"]],decls:27,vars:3,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card","card-plain"],[1,"card-header","card-header-info"],[1,"card-title"],["routerLink","/transaction/order-placement/add"],["alt","Add",1,"gridIcon"],[1,"card-category"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-hover"],[1,"text-primary"],[4,"ngIf"],[4,"ngFor","ngForOf"],["title","","data-toggle","tooltip","data-original-title","Download",1,"download",2,"cursor","pointer",3,"click"],[1,"routeIcon"],["title","","data-toggle","tooltip","data-original-title","Edit",1,"edit",3,"routerLink","queryParams"],["title","","data-toggle","tooltip","data-original-title","Delete",1,"delete",2,"cursor","pointer",3,"click"]],template:function(e,t){1&e&&(d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Order placement details "),d.Xb(8,"a",7),d.Xb(9,"mat-icon",8),d.Hc(10,"add"),d.Wb(),d.Wb(),d.Wb(),d.Sb(11,"p",9),d.Wb(),d.Xb(12,"div",10),d.Xb(13,"div",11),d.Xb(14,"table",12),d.Xb(15,"thead",13),d.Xb(16,"th"),d.Hc(17,"Order Code"),d.Wb(),d.Xb(18,"th"),d.Hc(19,"Project"),d.Wb(),d.Xb(20,"th"),d.Hc(21,"Supplier"),d.Wb(),d.Gc(22,_,2,0,"th",14),d.Gc(23,J,2,0,"th",14),d.Xb(24,"th"),d.Hc(25,"Action"),d.Wb(),d.Wb(),d.Gc(26,ee,20,10,"tbody",15),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()),2&e&&(d.Cb(22),d.oc("ngIf",!t.isMobileMenu()),d.Cb(1),d.oc("ngIf",!t.isMobileMenu()),d.Cb(3),d.oc("ngForOf",t.orders))},directives:[n.e,g.a,r.l,r.k],styles:[""]}),te);function ae(e,t){if(1&e&&(d.Xb(0,"div"),d.Xb(1,"p",6),d.Hc(2),d.Wb(),d.Wb()),2&e){var i=d.ic();d.Cb(2),d.Jc("Project Id : ",i.projectId,"")}}function re(e,t){1&e&&(d.Xb(0,"div"),d.Xb(1,"p",48),d.Hc(2,"Enter project data"),d.Wb(),d.Wb())}function ne(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"project Name is required"),d.Wb())}function oe(e,t){if(1&e&&(d.Xb(0,"mat-option",75),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.clientId),d.Cb(1),d.Jc(" ",i.clientName," ")}}function ce(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Customer is required "),d.Wb())}function le(e,t){if(1&e&&(d.Xb(0,"mat-option",75),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.clientId),d.Cb(1),d.Jc(" ",i.clientName," ")}}function de(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Purchase Order No is required"),d.Wb())}function se(e,t){if(1&e&&(d.Xb(0,"mat-option",75),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.value),d.Cb(1),d.Jc(" ",i.viewValue," ")}}function be(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Amount is required "),d.Wb())}function ue(e,t){1&e&&(d.Xb(0,"th"),d.Hc(1,"Rate"),d.Wb())}function me(e,t){1&e&&(d.Xb(0,"th"),d.Hc(1,"Amount"),d.Wb())}function fe(e,t){if(1&e&&(d.Xb(0,"td"),d.Hc(1),d.Wb()),2&e){var i=d.ic().$implicit;d.Cb(1),d.Ic(i.rate)}}function pe(e,t){if(1&e&&(d.Xb(0,"td"),d.Hc(1),d.Wb()),2&e){var i=d.ic().$implicit;d.Cb(1),d.Ic(i.amount)}}function he(e,t){if(1&e){var i=d.Yb();d.Xb(0,"tbody"),d.Xb(1,"tr"),d.Xb(2,"td"),d.Hc(3),d.Wb(),d.Xb(4,"td"),d.Hc(5),d.Wb(),d.Xb(6,"td"),d.Hc(7),d.Wb(),d.Gc(8,fe,2,1,"td",9),d.Gc(9,pe,2,1,"td",9),d.Xb(10,"td"),d.Xb(11,"a",76),d.fc("click",(function(){d.Ac(i);var e=t.$implicit,a=d.ic(),r=d.xc(128);return a.editDetail(e,r)})),d.Xb(12,"mat-icon",77),d.Hc(13,"edit"),d.Wb(),d.Wb(),d.Xb(14,"a",78),d.fc("click",(function(){d.Ac(i);var e=t.$implicit;return d.ic().openDialog(e)})),d.Xb(15,"mat-icon",77),d.Hc(16,"delete"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=t.$implicit,r=d.ic();d.Cb(3),d.Ic(a.rmName),d.Cb(2),d.Ic(a.quantity),d.Cb(2),d.Ic(a.unitId),d.Cb(1),d.oc("ngIf",!r.isMobileMenu()),d.Cb(1),d.oc("ngIf",!r.isMobileMenu())}}function ve(e,t){if(1&e){var i=d.Yb();d.Xb(0,"mat-option",79),d.fc("onSelectionChange",(function(){d.Ac(i);var e=t.$implicit;return d.ic().populateUnit(e)})),d.Hc(1),d.Wb()}if(2&e){var a=t.$implicit;d.oc("value",a.code),d.Cb(1),d.Jc(" ",a.name," ")}}function ge(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Raw material is required "),d.Wb())}function We(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Unit is required "),d.Wb())}function Xe(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Quantity is required "),d.Wb())}function ye(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Rate is required "),d.Wb())}function Ie(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Amount is required "),d.Wb())}var Ce,De=((Ce=function(){function e(t,i,a,r,n,o,c,l){var d=this;_classCallCheck(this,e),this.projectService=t,this.notificationService=i,this.rawMaterialService=a,this.clientService=r,this.unitService=n,this.dialog=o,this.route=c,this.datePipe=l,this.details=[],this.rawMaterials=[],this.customers=[],this.consignees=[],this.units=[],this.statusValues=[{value:"new",viewValue:"New"},{value:"running",viewValue:"On Going"},{value:"complete",viewValue:"Completed"}],this.hasError=function(e,t){return d.projectForm.controls[e].hasError(t)},this.hasDetailError=function(e,t){return d.projectDetailForm.controls[e].hasError(t)}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.getCustomers(),this.getConsignees(),this.findAllProducts(),this.projectForm=new o.e({projectId:new o.c(""),amendmentNo:new o.c(""),amendmentDate:new o.c(null),description:new o.c("",o.o.required),customerId:new o.c("",o.o.required),customerName:new o.c(""),consigneeId:new o.c(""),consigneeName:new o.c(""),projectStartDate:new o.c(null),projectStartDateString:new o.c(""),purchaseOrderNo:new o.c(""),purchaseOrderDate:new o.c(null),purchaseOrderDateString:new o.c(""),workOrderReference:new o.c(""),expectedDeliveryDate:new o.c(null,o.o.required),actualDeliveryDate:new o.c(null),expectedDeliveryDateString:new o.c(""),actualDeliveryDateString:new o.c(""),status:new o.c("",o.o.required),amount:new o.c(0),otherCharges:new o.c(0),cgstAmount:new o.c(0),sgstAmount:new o.c(0),totalAmount:new o.c(0),isActive:new o.c(""),details:new o.c(""),amendmentDateString:new o.c(""),notes:new o.c("")}),this.projectDetailForm=new o.e({projectId:new o.c(""),amendmentNo:new o.c(""),detailId:new o.c(""),rmId:new o.c("",o.o.required),rmName:new o.c(""),unitId:new o.c(""),unitName:new o.c("",o.o.required),quantity:new o.c(0,o.o.required),rate:new o.c(0),amount:new o.c(0)}),this.route.queryParams.subscribe((function(t){Object.keys(t).length>0&&e.projectService.findById(t.id,t.amendmentNo).subscribe((function(t){e.details=t.details,t.expectedDeliveryDate=e.convertToDate(t.expectedDeliveryDateString),t.actualDeliveryDate=e.convertToDate(t.actualDeliveryDateString),t.amendmentDate=e.convertToDate(t.amendmentDateString),t.projectStartDate=e.convertToDate(t.projectStartDateString),t.purchaseOrderDate=e.convertToDate(t.purchaseOrderDateString),e.projectForm.setValue(t),e.projectId=t.projectId}))}))}},{key:"convertToDate",value:function(e){var t=null;return null!=e&&e.length>0&&(t=new Date(e)),t}},{key:"onSubmit",value:function(){var e=this;this.projectForm.valid&&(this.project=this.projectForm.value,this.project.details=this.details,null!=this.projectForm.value.isActive&&""!=this.projectForm.value.isActive||(this.project.isActive=!0),this.project.expectedDeliveryDateString=this.datePipe.transform(this.project.expectedDeliveryDate,"dd/MM/yyyy"),null!=this.projectForm.value.actualDeliveryDate&&(this.project.actualDeliveryDateString=this.datePipe.transform(this.project.actualDeliveryDate,"dd/MM/yyyy")),null!=this.projectForm.value.purchaseOrderDate&&(this.project.purchaseOrderDateString=this.datePipe.transform(this.project.purchaseOrderDate,"dd/MM/yyyy")),null!=this.projectForm.value.projectStartDate&&(this.project.projectStartDateString=this.datePipe.transform(this.project.projectStartDate,"dd/MM/yyyy")),null==this.projectForm.value.amendmentDate?(this.project.amendmentDateString=this.datePipe.transform(new Date,"dd/MM/yyyy"),this.project.amendmentNo=0):this.project.amendmentDateString=this.datePipe.transform(this.project.amendmentDate,"dd/MM/yyyy"),this.projectService.save(this.project).subscribe((function(t){e.notificationService.openSnackBar(t.message,t.status),console.log("success response ::"),console.log(t),e.projectForm.reset(),e.projectId="",e.details=[]}),(function(t){e.notificationService.openSnackBar(t.error.message,t.error.status),console.log("error response ::"),console.log(t.message)}))),console.log(this.projectForm.value)}},{key:"onDetailSubmit",value:function(e){if(this.projectDetailForm.valid){var t,i=this.projectDetailForm.value,a=i.projectId;t=this.details.findIndex(null!=a&&a.length>0?function(e){return e.projectId==a}:function(e){return e.rmId==i.rmId}),console.log("last index >>"+t),-1!=t?(this.details[t]=this.projectDetailForm.value,this.notificationService.openSnackBar("Project details updated successfully","success")):(this.details.push(this.projectDetailForm.value),this.notificationService.openSnackBar("Project details added successfully","success")),this.calculateTotalDetailAmount(),this.projectDetailForm.reset(),e.hide()}else this.notificationService.openSnackBar("Error occurred, please review and submit again","danger")}},{key:"calculateTotalDetailAmount",value:function(){var e=this.details.map((function(e){return e.amount})).reduce((function(e,t){return Number.parseFloat(e.toString())+Number.parseFloat(t.toString())}),0);this.headerAmount=Number.parseFloat(e.toString()).toFixed(2),this.calculateFromGrid()}},{key:"findAllProducts",value:function(){var e=this;this.rawMaterialService.findAllProducts().subscribe((function(t){e.rawMaterials=t}))}},{key:"getCustomers",value:function(){var e=this;this.clientService.findAll().subscribe((function(t){e.customers=t}))}},{key:"getConsignees",value:function(){var e=this;this.clientService.findAll().subscribe((function(t){e.consignees=t}))}},{key:"getUnits",value:function(){var e=this;this.unitService.getAllUnits().subscribe((function(t){e.units=t}))}},{key:"close",value:function(e){e.hide()}},{key:"populateUnit",value:function(e){this.unitId=e.unitId,this.unitName=e.unitName,this.rmName=e.name}},{key:"editDetail",value:function(e,t){this.projectDetailForm.setValue(e),t.show()}},{key:"openDialog",value:function(e){var t=this;this.dialog.open(l.a,{width:"250px",data:{header:"Confirm",content:"Are you sure to delete?"}}).afterClosed().subscribe((function(i){i&&t.deleteDetail(e)}))}},{key:"deleteDetail",value:function(e){var t=this,i=this.calculateDetailIndex(e);e.projectId?this.projectService.deleteDetail(e.projectId,e.amendmentNo,e.detailId).subscribe((function(e){t.details.splice(i,1),t.calculateTotalDetailAmount(),t.notificationService.openSnackBar(e.message,e.status)}),(function(e){t.notificationService.openSnackBar(e.error.message,e.error.status),console.log("error response ::"),console.log(e.message)})):-1!==i&&(this.details.splice(i,1),this.calculateTotalDetailAmount(),this.notificationService.openSnackBar("Order details removed successfully","success"))}},{key:"calculateDetailIndex",value:function(e){return this.details.findIndex(null!=e.projectId&&e.projectId.length>0?function(t){return t.projectId==e.projectId}:function(t){return t.rmId==e.rmId})}},{key:"calculateHeader",value:function(){this.calculate(this.projectForm.value.amount)}},{key:"calculateFromGrid",value:function(){this.calculate(this.headerAmount)}},{key:"calculate",value:function(e){var t=this.projectForm.value.otherCharges,i=0;Object(c.a)(e)&&(i+=Number.parseFloat(e.toString())),Object(c.a)(t)&&(i+=Number.parseFloat(t.toString())),this.cgstAmount=(9*i/100).toFixed(2),this.sgstAmount=(9*i/100).toFixed(2),this.totalAmount=(i+Number.parseFloat(this.cgstAmount)+Number.parseFloat(this.sgstAmount)).toFixed(2)}},{key:"calculateDetail",value:function(){var e=this.projectDetailForm.value.quantity,t=this.projectDetailForm.value.rate;Object(c.a)(e)&&Object(c.a)(t)&&(this.detailAmount=(Number.parseFloat(t.toString())*Number.parseFloat(e.toString())).toFixed(2))}},{key:"isMobileMenu",value:function(){return!($(window).width()>991)}},{key:"modalWIdth",value:function(){return this.isMobileMenu()?"100%":"150%"}}]),e}()).\u0275fac=function(e){return new(e||Ce)(d.Rb(p.a),d.Rb(u.a),d.Rb(m.a),d.Rb(f.a),d.Rb(h.a),d.Rb(v.b),d.Rb(n.a),d.Rb(r.d))},Ce.\u0275cmp=d.Lb({type:Ce,selectors:[["app-project"]],decls:170,vars:45,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header","card-header-success"],[1,"card-title"],["routerLink","/transaction/projects"],[1,"gridIcon"],[4,"ngIf"],[1,"card-body"],[3,"formGroup","ngSubmit"],["headerForm","ngForm"],[1,"col-md-3"],[1,"invisible","example-full-width"],["matInput","","placeholder","projectId","formControlName","projectId"],["matInput","","placeholder","amendmentNo","formControlName","amendmentNo"],["matInput","","placeholder","amendmentDate","formControlName","amendmentDate"],["matInput","","placeholder","isActive","formControlName","isActive"],[1,"example-full-width"],["matInput","","placeholder","Project Name","formControlName","description"],[1,"col-md-2"],["placeholder","Customer","formControlName","customerId"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Consignee (If any)","formControlName","consigneeId"],["matInput","","placeholder","Purchase Order No","formControlName","purchaseOrderNo"],["matInput","","formControlName","purchaseOrderDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker1",""],["matInput","","placeholder","Offer Reference No","formControlName","workOrderReference"],["matInput","","formControlName","projectStartDate",3,"matDatepicker"],["picker2",""],["matInput","","formControlName","expectedDeliveryDate",3,"matDatepicker"],["picker3",""],["placeholder","Status","formControlName","status"],["matInput","","formControlName","actualDeliveryDate",3,"matDatepicker"],["picker4",""],["matInput","","placeholder","Amount","formControlName","amount",2,"text-align","right",3,"ngModel","readonly","ngModelChange","change"],["matInput","","placeholder","Other Charges (if any)","formControlName","otherCharges",2,"text-align","right",3,"change"],["matInput","","placeholder","CGST","formControlName","cgstAmount",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","SGST","formControlName","sgstAmount",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","Total Amount","formControlName","totalAmount",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],[1,"card","card-plain"],[1,"card-header","card-header-info"],["width","100%"],["width","90%"],[2,"align-content","justify-content-right"],["type","button","mdbBtn","","color","unique","rounded","true","data-toggle","modal","data-target","#basicExample","mdbWavesEffect","",3,"click"],[1,"card-category"],[1,"table-responsive"],[1,"table","table-hover"],[1,"text-primary"],[4,"ngFor","ngForOf"],["mat-raised-button","","type","submit",1,"btn","btn-success","pull-right",3,"disabled","click"],[1,"clearfix"],["mdbModal","","id","frameModalTop","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade","left"],["frame","mdbModal"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","text-center"],[1,"modal-title","w-100","font-weight-bold"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[3,"formGroup"],[1,"col-md-4"],["matInput","","placeholder","rmName","formControlName","rmName",3,"ngModel","ngModelChange"],["placeholder","Product","formControlName","rmId"],[3,"value","onSelectionChange",4,"ngFor","ngForOf"],["matInput","","placeholder","Unit","formControlName","unitId",3,"ngModel","ngModelChange"],["matInput","","placeholder","Unit","formControlName","unitName",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","Quantity","formControlName","quantity",2,"text-align","right",3,"change"],["matInput","","placeholder","Rate","formControlName","rate",2,"text-align","right",3,"change"],["matInput","","placeholder","Amount","formControlName","amount",2,"text-align","right",3,"ngModel","readonly","ngModelChange"],[1,"modal-footer","d-flex","justify-content-right"],["mdbBtn","","color","deep-orange","mdbWavesEffect","",1,"waves-light",3,"click"],[3,"value"],["title","","data-toggle","tooltip","data-original-title","Edit",1,"edit",2,"cursor","pointer",3,"click"],[1,"routeIcon"],["title","","data-toggle","tooltip","data-original-title","Delete",1,"delete",2,"cursor","pointer",3,"click"],[3,"value","onSelectionChange"]],template:function(e,t){if(1&e){var i=d.Yb();d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Create and Update Project Details "),d.Xb(8,"a",7),d.Xb(9,"mat-icon",8),d.Hc(10,"web"),d.Wb(),d.Wb(),d.Wb(),d.Gc(11,ae,3,1,"div",9),d.Gc(12,re,3,0,"div",9),d.Wb(),d.Xb(13,"div",10),d.Xb(14,"form",11,12),d.fc("ngSubmit",(function(){return t.onSubmit()})),d.Xb(16,"div",2),d.Xb(17,"div",13),d.Xb(18,"mat-form-field",14),d.Sb(19,"input",15),d.Sb(20,"input",16),d.Sb(21,"input",17),d.Sb(22,"input",18),d.Wb(),d.Xb(23,"mat-form-field",19),d.Sb(24,"input",20),d.Gc(25,ne,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(26,"div",21),d.Xb(27,"mat-form-field",19),d.Xb(28,"mat-select",22),d.Gc(29,oe,2,2,"mat-option",23),d.Wb(),d.Gc(30,ce,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(31,"div",21),d.Xb(32,"mat-form-field",19),d.Xb(33,"mat-select",24),d.Gc(34,le,2,2,"mat-option",23),d.Wb(),d.Wb(),d.Wb(),d.Xb(35,"div",13),d.Xb(36,"mat-form-field",19),d.Sb(37,"input",25),d.Gc(38,de,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(39,"div",21),d.Xb(40,"mat-form-field"),d.Xb(41,"mat-label"),d.Hc(42,"Purchase Order Date"),d.Wb(),d.Sb(43,"input",26),d.Sb(44,"mat-datepicker-toggle",27),d.Sb(45,"mat-datepicker",null,28),d.Wb(),d.Wb(),d.Wb(),d.Xb(47,"div",2),d.Xb(48,"div",13),d.Xb(49,"mat-form-field",19),d.Sb(50,"input",29),d.Wb(),d.Wb(),d.Xb(51,"div",21),d.Xb(52,"mat-form-field"),d.Xb(53,"mat-label"),d.Hc(54,"Project Start Date"),d.Wb(),d.Sb(55,"input",30),d.Sb(56,"mat-datepicker-toggle",27),d.Sb(57,"mat-datepicker",null,31),d.Wb(),d.Wb(),d.Xb(59,"div",21),d.Xb(60,"mat-form-field"),d.Xb(61,"mat-label"),d.Hc(62,"PO Delivery Date"),d.Wb(),d.Sb(63,"input",32),d.Sb(64,"mat-datepicker-toggle",27),d.Sb(65,"mat-datepicker",null,33),d.Wb(),d.Wb(),d.Xb(67,"div",13),d.Xb(68,"mat-form-field",19),d.Xb(69,"mat-select",34),d.Gc(70,se,2,2,"mat-option",23),d.Wb(),d.Wb(),d.Wb(),d.Xb(71,"div",21),d.Xb(72,"mat-form-field"),d.Xb(73,"mat-label"),d.Hc(74,"Actual Delivery Date"),d.Wb(),d.Sb(75,"input",35),d.Sb(76,"mat-datepicker-toggle",27),d.Sb(77,"mat-datepicker",null,36),d.Wb(),d.Wb(),d.Wb(),d.Xb(79,"div",2),d.Xb(80,"div",21),d.Xb(81,"mat-form-field",19),d.Xb(82,"input",37),d.fc("ngModelChange",(function(e){return t.headerAmount=e}))("change",(function(){return t.calculateHeader()})),d.Wb(),d.Gc(83,be,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(84,"div",21),d.Xb(85,"mat-form-field",19),d.Xb(86,"input",38),d.fc("change",(function(){return t.calculateHeader()})),d.Wb(),d.Wb(),d.Wb(),d.Xb(87,"div",21),d.Xb(88,"mat-form-field",19),d.Xb(89,"input",39),d.fc("ngModelChange",(function(e){return t.cgstAmount=e})),d.Wb(),d.Wb(),d.Wb(),d.Xb(90,"div",21),d.Xb(91,"mat-form-field",19),d.Xb(92,"input",40),d.fc("ngModelChange",(function(e){return t.sgstAmount=e})),d.Wb(),d.Wb(),d.Wb(),d.Xb(93,"div",21),d.Xb(94,"mat-form-field",19),d.Xb(95,"input",41),d.fc("ngModelChange",(function(e){return t.totalAmount=e})),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(96,"div",2),d.Xb(97,"div",3),d.Xb(98,"div",42),d.Xb(99,"div",43),d.Xb(100,"table",44),d.Xb(101,"tr"),d.Xb(102,"td",45),d.Xb(103,"h4",6),d.Hc(104,"Project Dteails"),d.Wb(),d.Wb(),d.Xb(105,"td",46),d.Xb(106,"button",47),d.fc("click",(function(){return d.Ac(i),d.xc(128).show()})),d.Hc(107," Add "),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Sb(108,"p",48),d.Wb(),d.Xb(109,"div",10),d.Xb(110,"div",49),d.Xb(111,"table",50),d.Xb(112,"thead",51),d.Xb(113,"th"),d.Hc(114,"Product"),d.Wb(),d.Xb(115,"th"),d.Hc(116,"Quantity"),d.Wb(),d.Xb(117,"th"),d.Hc(118,"Unit"),d.Wb(),d.Gc(119,ue,2,0,"th",9),d.Gc(120,me,2,0,"th",9),d.Xb(121,"th"),d.Hc(122,"Action"),d.Wb(),d.Wb(),d.Gc(123,he,17,5,"tbody",52),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(124,"button",53),d.fc("click",(function(){return d.Ac(i),d.xc(15).ngSubmit.emit()})),d.Hc(125,"Save"),d.Wb(),d.Sb(126,"div",54),d.Xb(127,"div",55,56),d.Xb(129,"div",57),d.Xb(130,"div",58),d.Xb(131,"div",59),d.Xb(132,"h4",60),d.Hc(133,"Project Detail Entry"),d.Wb(),d.Xb(134,"button",61),d.fc("click",(function(){d.Ac(i);var e=d.xc(128);return t.close(e)})),d.Xb(135,"span",62),d.Hc(136,"\xd7"),d.Wb(),d.Wb(),d.Wb(),d.Xb(137,"div",10),d.Xb(138,"form",63),d.Xb(139,"div",2),d.Xb(140,"div",64),d.Xb(141,"mat-form-field",14),d.Sb(142,"input",15),d.Sb(143,"input",16),d.Xb(144,"input",65),d.fc("ngModelChange",(function(e){return t.rmName=e})),d.Wb(),d.Wb(),d.Xb(145,"mat-form-field",19),d.Xb(146,"mat-select",66),d.Gc(147,ve,2,2,"mat-option",67),d.Wb(),d.Gc(148,ge,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(149,"div",21),d.Xb(150,"mat-form-field",14),d.Xb(151,"input",68),d.fc("ngModelChange",(function(e){return t.unitId=e})),d.Wb(),d.Wb(),d.Xb(152,"mat-form-field",19),d.Xb(153,"input",69),d.fc("ngModelChange",(function(e){return t.unitName=e})),d.Wb(),d.Gc(154,We,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(155,"div",21),d.Xb(156,"mat-form-field",19),d.Xb(157,"input",70),d.fc("change",(function(){return t.calculateDetail()})),d.Wb(),d.Gc(158,Xe,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(159,"div",21),d.Xb(160,"mat-form-field",19),d.Xb(161,"input",71),d.fc("change",(function(){return t.calculateDetail()})),d.Wb(),d.Gc(162,ye,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(163,"div",21),d.Xb(164,"mat-form-field",19),d.Xb(165,"input",72),d.fc("ngModelChange",(function(e){return t.detailAmount=e})),d.Wb(),d.Gc(166,Ie,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Wb(),d.Xb(167,"div",73),d.Xb(168,"button",74),d.fc("click",(function(){d.Ac(i);var e=d.xc(128);return t.onDetailSubmit(e)})),d.Hc(169,"Save"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=d.xc(15),r=d.xc(46),n=d.xc(58),o=d.xc(66),c=d.xc(78);d.Cb(11),d.oc("ngIf",t.projectId),d.Cb(1),d.oc("ngIf",!t.projectId),d.Cb(2),d.oc("formGroup",t.projectForm),d.Cb(11),d.oc("ngIf",t.hasError("description","required")),d.Cb(4),d.oc("ngForOf",t.customers),d.Cb(1),d.oc("ngIf",t.hasError("customerId","required")),d.Cb(4),d.oc("ngForOf",t.consignees),d.Cb(4),d.oc("ngIf",t.hasError("purchaseOrderNo","required")),d.Cb(5),d.oc("matDatepicker",r),d.Cb(1),d.oc("for",r),d.Cb(11),d.oc("matDatepicker",n),d.Cb(1),d.oc("for",n),d.Cb(7),d.oc("matDatepicker",o),d.Cb(1),d.oc("for",o),d.Cb(6),d.oc("ngForOf",t.statusValues),d.Cb(5),d.oc("matDatepicker",c),d.Cb(1),d.oc("for",c),d.Cb(6),d.oc("ngModel",t.headerAmount)("readonly",!0),d.Cb(1),d.oc("ngIf",t.hasError("amount","required")),d.Cb(6),d.oc("readonly",!0)("ngModel",t.cgstAmount),d.Cb(3),d.oc("readonly",!0)("ngModel",t.sgstAmount),d.Cb(3),d.oc("readonly",!0)("ngModel",t.totalAmount),d.Cb(24),d.oc("ngIf",!t.isMobileMenu()),d.Cb(1),d.oc("ngIf",!t.isMobileMenu()),d.Cb(3),d.oc("ngForOf",t.details),d.Cb(1),d.oc("disabled",!a.form.valid),d.Cb(6),d.Fc("width",t.modalWIdth()),d.Cb(8),d.oc("formGroup",t.projectDetailForm),d.Cb(6),d.oc("ngModel",t.rmName),d.Cb(3),d.oc("ngForOf",t.rawMaterials),d.Cb(1),d.oc("ngIf",t.hasDetailError("rmId","required")),d.Cb(3),d.oc("ngModel",t.unitId),d.Cb(2),d.oc("readonly",!0)("ngModel",t.unitName),d.Cb(1),d.oc("ngIf",t.hasDetailError("unitName","required")),d.Cb(4),d.oc("ngIf",t.hasDetailError("quantity","required")),d.Cb(4),d.oc("ngIf",t.hasDetailError("rate","required")),d.Cb(3),d.oc("ngModel",t.detailAmount)("readonly",!0),d.Cb(1),d.oc("ngIf",t.hasDetailError("amount","required"))}},directives:[n.e,g.a,r.l,o.p,o.l,o.f,W.c,X.b,o.a,o.k,o.d,y.a,r.k,W.f,I.b,I.d,W.g,I.a,C.b,C.c,W.b,D.l],styles:[".gridIcon[_ngcontent-%COMP%]{vertical-align:middle;float:right}"]}),Ce);function Se(e,t){1&e&&(d.Xb(0,"th"),d.Hc(1,"Estimated delivery date"),d.Wb())}function ke(e,t){1&e&&(d.Xb(0,"th"),d.Hc(1,"Status"),d.Wb())}function we(e,t){if(1&e&&(d.Xb(0,"td"),d.Hc(1),d.Wb()),2&e){var i=d.ic().$implicit;d.Cb(1),d.Ic(i.expectedDeliveryDateString)}}function Me(e,t){if(1&e&&(d.Xb(0,"td"),d.Hc(1),d.Wb()),2&e){var i=d.ic().$implicit;d.Cb(1),d.Ic(i.status)}}var Fe=function(){return["/transaction/projects/edit"]},He=function(e,t){return{id:e,amendmentNo:t}};function Ne(e,t){if(1&e){var i=d.Yb();d.Xb(0,"tbody"),d.Xb(1,"tr"),d.Xb(2,"td"),d.Hc(3),d.Wb(),d.Xb(4,"td"),d.Hc(5),d.Wb(),d.Xb(6,"td"),d.Hc(7),d.Wb(),d.Gc(8,we,2,1,"td",14),d.Gc(9,Me,2,1,"td",14),d.Xb(10,"td"),d.Xb(11,"a",16),d.Xb(12,"mat-icon",17),d.Hc(13,"edit"),d.Wb(),d.Wb(),d.Xb(14,"a",18),d.fc("click",(function(){d.Ac(i);var e=t.$implicit;return d.ic().openDialog(e)})),d.Xb(15,"mat-icon",17),d.Hc(16,"delete"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=t.$implicit,r=d.ic();d.Cb(3),d.Ic(a.projectId),d.Cb(2),d.Ic(a.description),d.Cb(2),d.Ic(a.customerName),d.Cb(1),d.oc("ngIf",!r.isMobileMenu()),d.Cb(1),d.oc("ngIf",!r.isMobileMenu()),d.Cb(2),d.oc("routerLink",d.qc(7,Fe))("queryParams",d.sc(8,He,a.projectId,a.amendmentNo))}}var xe,Ae,je=((xe=function(){function e(t,i,a){_classCallCheck(this,e),this.projectService=t,this.notificationService=i,this.dialog=a,this.projects=[]}return _createClass(e,[{key:"ngOnInit",value:function(){this.findAll()}},{key:"findAll",value:function(){var e=this;this.projectService.findAll().subscribe((function(t){e.projects=t}))}},{key:"delete",value:function(e){var t=this;this.projectService.delete(e.projectId,e.amendmentNo).subscribe((function(e){console.log("Delete Response >>>>"),console.log(e),t.notificationService.openSnackBar(e.message,e.status),t.findAll()}))}},{key:"openDialog",value:function(e){var t=this;this.dialog.open(l.a,{width:"250px",data:{header:"Confirm",content:"Are you sure to delete?"}}).afterClosed().subscribe((function(i){i&&t.delete(e)}))}},{key:"isMobileMenu",value:function(){return!($(window).width()>991)}}]),e}()).\u0275fac=function(e){return new(e||xe)(d.Rb(p.a),d.Rb(u.a),d.Rb(v.b))},xe.\u0275cmp=d.Lb({type:xe,selectors:[["app-project-show"]],decls:27,vars:3,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card","card-plain"],[1,"card-header","card-header-info"],[1,"card-title"],["routerLink","/transaction/project/add"],[1,"gridIcon"],[1,"card-category"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-hover"],[1,"text-primary"],[4,"ngIf"],[4,"ngFor","ngForOf"],["title","","data-toggle","tooltip","data-original-title","Edit",1,"edit",3,"routerLink","queryParams"],[1,"routeIcon"],["title","","data-toggle","tooltip","data-original-title","Delete",1,"delete",2,"cursor","pointer",3,"click"]],template:function(e,t){1&e&&(d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Project details "),d.Xb(8,"a",7),d.Xb(9,"mat-icon",8),d.Hc(10,"add"),d.Wb(),d.Wb(),d.Wb(),d.Sb(11,"p",9),d.Wb(),d.Xb(12,"div",10),d.Xb(13,"div",11),d.Xb(14,"table",12),d.Xb(15,"thead",13),d.Xb(16,"th"),d.Hc(17,"Project Code"),d.Wb(),d.Xb(18,"th"),d.Hc(19,"Description"),d.Wb(),d.Xb(20,"th"),d.Hc(21,"Customer"),d.Wb(),d.Gc(22,Se,2,0,"th",14),d.Gc(23,ke,2,0,"th",14),d.Xb(24,"th"),d.Hc(25,"Action"),d.Wb(),d.Wb(),d.Gc(26,Ne,17,11,"tbody",15),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()),2&e&&(d.Cb(22),d.oc("ngIf",!t.isMobileMenu()),d.Cb(1),d.oc("ngIf",!t.isMobileMenu()),d.Cb(3),d.oc("ngForOf",t.projects))},directives:[n.e,g.a,r.l,r.k],styles:[""]}),xe),qe=function e(){_classCallCheck(this,e),this.details=[]},Ge=function e(){_classCallCheck(this,e)},Oe=i("5Iue"),Pe=((Ae=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"save",value:function(e){return this.http.post("transaction/delivery",e)}},{key:"findAll",value:function(){return this.http.get("transaction/deliveries")}},{key:"findById",value:function(e){return this.http.get("transaction/deliveries/find",{params:{id:e}})}},{key:"delete",value:function(e){return this.http.delete("transaction/deliveries/delete",{params:{id:e}})}},{key:"deleteDetail",value:function(e,t){var i=new s.d;return i=(i=i.append("id",e)).append("detailId",t.toString()),this.http.delete("transaction/deliveries/detail/delete",{params:i})}}]),e}()).\u0275fac=function(e){return new(e||Ae)(d.bc(s.b))},Ae.\u0275prov=d.Nb({token:Ae,factory:Ae.\u0275fac,providedIn:"root"}),Ae);function Ee(e,t){if(1&e&&(d.Xb(0,"div"),d.Xb(1,"p",6),d.Hc(2),d.Wb(),d.Wb()),2&e){var i=d.ic();d.Cb(2),d.Jc("Delivery Id : ",i.deliveryId,"")}}function Re(e,t){1&e&&(d.Xb(0,"div"),d.Xb(1,"p",38),d.Hc(2,"Enter order delivery details for raw materials"),d.Wb(),d.Wb())}function Te(e,t){if(1&e&&(d.Xb(0,"mat-option",67),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.clientId),d.Cb(1),d.Jc(" ",i.clientName," ")}}function Ue(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Supplier is required"),d.Wb())}function Be(e,t){if(1&e&&(d.Xb(0,"mat-option",67),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.detailId),d.Cb(1),d.Jc(" ",i.identifier," ")}}function Le(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Bill no is required"),d.Wb())}function $e(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Amount is required "),d.Wb())}function Ve(e,t){if(1&e){var i=d.Yb();d.Xb(0,"td"),d.Xb(1,"a",68),d.fc("click",(function(){d.Ac(i);var e=d.ic().$implicit,t=d.ic(),a=d.xc(96);return t.editDetail(e,a)})),d.Xb(2,"mat-icon",69),d.Hc(3,"edit"),d.Wb(),d.Wb(),d.Xb(4,"a",70),d.fc("click",(function(){d.Ac(i);var e=d.ic().$implicit;return d.ic().openDialog(e)})),d.Xb(5,"mat-icon",69),d.Hc(6,"delete"),d.Wb(),d.Wb(),d.Wb()}}function Qe(e,t){if(1&e&&(d.Xb(0,"tbody"),d.Xb(1,"tr"),d.Xb(2,"td"),d.Hc(3),d.Wb(),d.Xb(4,"td"),d.Hc(5),d.Wb(),d.Xb(6,"td"),d.Hc(7),d.Wb(),d.Xb(8,"td"),d.Hc(9),d.Wb(),d.Xb(10,"td"),d.Hc(11),d.Wb(),d.Gc(12,Ve,7,0,"td",9),d.Wb(),d.Wb()),2&e){var i=t.$implicit;d.Cb(3),d.Ic(i.rmName),d.Cb(2),d.Ic(i.quantity),d.Cb(2),d.Ic(i.unitId),d.Cb(2),d.Ic(i.rate),d.Cb(2),d.Ic(i.amount),d.Cb(1),d.oc("ngIf",""==i.deliveryId)}}function _e(e,t){if(1&e){var i=d.Yb();d.Xb(0,"mat-option",71),d.fc("onSelectionChange",(function(){d.Ac(i);var e=t.$implicit;return d.ic().populateUnit(e)})),d.Hc(1),d.Wb()}if(2&e){var a=t.$implicit;d.oc("value",a.code),d.Cb(1),d.Jc(" ",a.name," ")}}function Je(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Raw material is required"),d.Wb())}function Ye(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Unit is required "),d.Wb())}function Ke(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Quantity is required "),d.Wb())}function ze(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Quantity should be less than remaining quantity "),d.Wb())}function Ze(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Rate is required "),d.Wb())}function et(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Amount is required "),d.Wb())}var tt,it=((tt=function(){function e(t,i,a,r,n,o,c,l,d){var s=this;_classCallCheck(this,e),this.orderDeliveryService=t,this.orderPlacementService=i,this.notificationService=a,this.clientService=r,this.dialog=n,this.route=o,this.fb=c,this.datePipe=l,this.rawMaterialService=d,this.details=[],this.orders=[],this.workUnits=[{value:"DUMDUM",viewValue:"Dum dum unit"},{value:"SINGUR",viewValue:"Singur Unit"}],this.paymentStatusValues=[{value:!0,viewValue:"Yes"},{value:!1,viewValue:"No"}],this.od=new qe,this.consignees=[],this.consigneeDetails=[],this.suppliers=[],this.supplierDetails=[],this.rawMaterials=[],this.filteredRawMaterialIds=[],this.filteredRawMaterials=[],this.siteId="SINGUR",this.isActive=!0,this.hasError=function(e,t){return s.deliveryForm.controls[e].hasError(t)},this.hasDetailError=function(e,t){return s.deliveryDetailsForm.controls[e].hasError(t)}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.getOrders(),this.getConsignees(),this.getSuppliers(),this.getRawMaterials(),this.deliveryForm=new o.e({deliveryId:new o.c(""),billNo:new o.c("",o.o.required),billDate:new o.c(null,o.o.required),billDateString:new o.c(""),supplierId:new o.c(""),supplierName:new o.c(""),supplierIdentifier:new o.c(""),supplierDetailsId:new o.c(""),consigneeId:new o.c(""),consigneeName:new o.c(""),consigneeDetailsId:new o.c(""),consigneeIdentifier:new o.c(""),vehicleNo:new o.c(""),amount:new o.c(null),freightCharges:new o.c(null),cgstAmount:new o.c(null),sgstAmount:new o.c(null),totalAmount:new o.c(null),notes:new o.c(""),siteId:new o.c(""),isActive:new o.c(!0),details:new o.c(""),projectId:new o.c("")}),this.deliveryDetailsForm=this.fb.group({deliveryId:new o.c(""),detailId:new o.c(""),rmId:new o.c("",o.o.required),rmName:new o.c(""),unitId:new o.c(""),unitName:new o.c("",o.o.required),quantity:new o.c(null,[o.o.required]),rate:new o.c(null),amount:new o.c(null),oldQuantity:new o.c(null)}),this.route.queryParams.subscribe((function(t){Object.keys(t).length>0&&e.orderDeliveryService.findById(t.id).subscribe((function(t){e.details=t.details,t.billDate=Object(Oe.a)(t.billDateString),e.filterSupplierDateilsEdit(t.supplierId),e.deliveryId=t.deliveryId,e.deliveryForm.setValue(t),e.headerAmount=Number.parseFloat(t.amount.toString()).toFixed(2),e.cgstAmount=Number.parseFloat(t.cgstAmount.toString()).toFixed(2),e.sgstAmount=Number.parseFloat(t.sgstAmount.toString()).toFixed(2),e.totalAmount=Number.parseFloat(t.totalAmount.toString()).toFixed(2),e.filteredRawMaterialIds=e.details.map((function(e){return e.rmId}))}))}))}},{key:"onSubmit",value:function(){var e=this;this.deliveryForm.valid&&(this.orderDelivery=this.deliveryForm.value,this.orderDelivery.details=this.details,null!=this.deliveryForm.value.isActive&&""!=this.deliveryForm.value.isActive||(this.orderDelivery.isActive=!0),null!=this.deliveryForm.value.billDate&&(this.orderDelivery.billDateString=this.datePipe.transform(this.orderDelivery.billDate,"dd/MM/yyyy")),this.orderDeliveryService.save(this.orderDelivery).subscribe((function(t){e.notificationService.openSnackBar(t.message,t.status),console.log("success response ::"),console.log(t),e.deliveryForm.reset(),e.details=[]}),(function(t){e.notificationService.openSnackBar(t.error.message,t.error.status),console.log("error response ::"),console.log(t.message)})))}},{key:"onDetailSubmit",value:function(e){if(this.deliveryDetailsForm.valid){var t,i=this.deliveryDetailsForm.value,a=i.deliveryId;t=this.details.findIndex(null!=a&&a.length>0?function(e){return e.deliveryId==a}:function(e){return e.rmId==i.rmId}),console.log("last index >>"+t),-1!=t?(this.details[t]=this.deliveryDetailsForm.value,this.notificationService.openSnackBar("Order details updated successfully","success")):(this.details.push(this.deliveryDetailsForm.value),this.notificationService.openSnackBar("Order details added successfully","success")),this.deliveryDetailsForm.reset(),this.headerAmount=this.calculateTotalDetailAmount(),this.calculate(this.headerAmount),this.filteredRawMaterialIds.push(this.deliveryDetailsForm.value.rmId),e.hide()}else this.notificationService.openSnackBar("Error occurred, please review and submit again","danger")}},{key:"close",value:function(e){e.hide()}},{key:"editDetail",value:function(e,t){this.deliveryDetailsForm.patchValue(e),t.show()}},{key:"openDialog",value:function(e){var t=this;this.dialog.open(l.a,{width:"250px",data:{header:"Confirm",content:"Are you sure to delete?"}}).afterClosed().subscribe((function(i){i&&t.deleteDetail(e)}))}},{key:"deleteDetail",value:function(e){var t=this,i=this.calculateDetailIndex(e);e.detailId?this.orderDeliveryService.deleteDetail(e.deliveryId,e.detailId).subscribe((function(e){t.details.splice(i,1),t.headerAmount=t.calculateTotalDetailAmount(),t.calculate(t.headerAmount),t.notificationService.openSnackBar(e.message,e.status)}),(function(e){t.notificationService.openSnackBar(e.error.message,e.error.status),console.log("error response ::"),console.log(e.message)})):-1!==i&&(this.details.splice(i,1),this.headerAmount=this.calculateTotalDetailAmount(),this.calculate(this.headerAmount),this.notificationService.openSnackBar("Order details removed successfully","success"))}},{key:"calculateDetailIndex",value:function(e){return this.details.findIndex(null!=e.detailId?function(t){return t.detailId==e.detailId}:function(t){return t.rmId==e.rmId})}},{key:"calculateDetail",value:function(){var e=this.deliveryDetailsForm.value.quantity,t=this.deliveryDetailsForm.value.rate;Object(c.a)(e)&&Object(c.a)(t)&&(this.detailAmount=(Number.parseFloat(t.toString())*Number.parseFloat(e.toString())).toFixed(2))}},{key:"getOrders",value:function(){var e=this;this.orderPlacementService.findAll().subscribe((function(t){e.orders=t}))}},{key:"populatOrder",value:function(e){var t=e.value,i=this.orders.filter((function(e){return e.orderId===t}))[0];this.populateOrderDelivery(i)}},{key:"populateOrderDelivery",value:function(e){var t=this;this.details=[],this.od.supplierId=e.supplierId,this.od.supplierName=e.supplierName,this.od.supplierDetailsId=e.supplierDetailsId,this.od.supplierIdentifier=e.identifier,this.od.siteId=e.siteId,this.od.projectId=e.projectId,e.details.forEach((function(e){var i=new Ge;i.rmId=e.rmId,i.rmName=e.rmName,i.unitId=e.unitId,i.unitName=e.unitName,i.quantity=e.quantity,i.rate=e.rate,i.amount=Number.parseFloat(i.quantity.toString())*Number.parseFloat(e.rate.toString()),t.details.push(i)})),this.headerAmount=this.calculateTotalDetailAmount(),this.calculate(this.headerAmount)}},{key:"calculateTotalDetailAmount",value:function(){var e=this.details.map((function(e){return e.amount})).reduce((function(e,t){return Number.parseFloat(e.toString())+Number.parseFloat(t.toString())}),0);return Number.parseFloat(e.toString()).toFixed(2)}},{key:"getConsignees",value:function(){var e=this;this.clientService.findAll().subscribe((function(t){e.consignees=t}))}},{key:"populateConsigneeDetails",value:function(e){this.filterConsigneeDateils(e.value)}},{key:"filterConsigneeDateils",value:function(e){""!=e&&(this.consigneeDetails=this.consignees.filter((function(t){return t.clientId===e}))[0].details)}},{key:"calculateHeader",value:function(){this.calculate(this.deliveryForm.value.amount)}},{key:"calculate",value:function(e){var t=this.deliveryForm.value.freightCharges,i=0;Object(c.a)(e)&&(i+=Number.parseFloat(e.toString())),Object(c.a)(t)&&(i+=Number.parseFloat(t.toString())),this.cgstAmount=(9*i/100).toFixed(2),this.sgstAmount=(9*i/100).toFixed(2),this.totalAmount=(i+Number.parseFloat(this.cgstAmount)+Number.parseFloat(this.sgstAmount)).toFixed(2)}},{key:"isMobileMenu",value:function(){return!($(window).width()>991)}},{key:"modalWIdth",value:function(){return this.isMobileMenu()?"100%":"150%"}},{key:"getSuppliers",value:function(){var e=this;this.clientService.findAll().subscribe((function(t){e.suppliers=t}))}},{key:"populateSupplierDetails",value:function(e){this.filterSupplierDateils(e.value)}},{key:"filterSupplierDateils",value:function(e){this.supplierDetails=this.suppliers.filter((function(t){return t.clientId===e}))[0].details}},{key:"filterSupplierDateilsEdit",value:function(e){var t=this;this.clientService.findAll().subscribe((function(i){t.suppliers=i,t.supplierDetails=t.suppliers.filter((function(t){return t.clientId===e}))[0].details}))}},{key:"populateUnit",value:function(e){this.rmName=e.name,this.unitId=e.unitId,this.unitName=e.unitName}},{key:"getRawMaterials",value:function(){var e=this;this.rawMaterialService.findAllRawMaterials().subscribe((function(t){e.rawMaterials=t,e.filteredRawMaterials=t,e.rawMaterials.filter((function(t){return-1==e.filteredRawMaterialIds.indexOf(t.code)}))}))}},{key:"filterRawMaterials",value:function(){var e=this;this.filteredRawMaterials=this.rawMaterials.filter((function(t){return-1==e.filteredRawMaterialIds.indexOf(t.code)}))}}]),e}()).\u0275fac=function(e){return new(e||tt)(d.Rb(Pe),d.Rb(b),d.Rb(u.a),d.Rb(f.a),d.Rb(v.b),d.Rb(n.a),d.Rb(o.b),d.Rb(r.d),d.Rb(m.a))},tt.\u0275cmp=d.Lb({type:tt,selectors:[["app-order-delivery"]],decls:141,vars:38,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header","card-header-success"],[1,"card-title"],["routerLink","/transaction/deliveries"],[1,"gridIcon"],[4,"ngIf"],[1,"card-body"],[3,"formGroup","ngSubmit"],["headerForm","ngForm"],[1,"col-md-3"],[1,"invisible","example-full-width"],["matInput","","placeholder","deliveryId","formControlName","deliveryId"],["matInput","","placeholder","isActive","formControlName","isActive",3,"ngModel","ngModelChange"],["matInput","","placeholder","siteId","formControlName","siteId",3,"ngModel","ngModelChange"],[1,"example-full-width"],["placeholder","Supplier","formControlName","supplierId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Supplier Address","formControlName","supplierDetailsId"],[1,"col-md-2"],["matInput","","placeholder","Bill No","formControlName","billNo"],["matInput","","formControlName","billDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker1",""],["matInput","","placeholder","Vehicle No","formControlName","vehicleNo"],["matInput","","placeholder","Amount","formControlName","amount",2,"text-align","right",3,"ngModel","readonly","ngModelChange","change"],["matInput","","placeholder","Freight Charges","formControlName","freightCharges",2,"text-align","right",3,"change"],["matInput","","placeholder","CGST","formControlName","cgstAmount",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","SGST","formControlName","sgstAmount",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","Total Amount","formControlName","totalAmount",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],[1,"card-header","card-header-info"],["width","100%"],["width","90%"],[2,"align-content","justify-content-right"],["type","button","mdbBtn","","color","unique","rounded","true","data-toggle","modal","data-target","#basicExample","mdbWavesEffect","",3,"click"],[1,"card-category"],[1,"table-responsive"],[1,"table","table-hover"],[1,"text-primary"],[4,"ngFor","ngForOf"],["mat-raised-button","","type","submit",1,"btn","btn-success","pull-right",3,"disabled","click"],[1,"clearfix"],["mdbModal","","id","frameModalTop","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade","left"],["frame","mdbModal"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","text-center"],[1,"modal-title","w-100","font-weight-bold"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[3,"formGroup"],[1,"col-md-4"],["matInput","","placeholder","rmId","formControlName","rmId"],["matInput","","placeholder","oldQuantity","formControlName","oldQuantity"],["matInput","","formControlName","rmName",3,"ngModel","ngModelChange"],["placeholder","Raw Material","formControlName","rmId"],[3,"value","onSelectionChange",4,"ngFor","ngForOf"],["matInput","","placeholder","Unit","formControlName","unitId",3,"ngModel","ngModelChange"],["matInput","","placeholder","Unit","formControlName","unitName",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","Quantity","formControlName","quantity",2,"text-align","right",3,"change"],["matInput","","placeholder","Rate","formControlName","rate",2,"text-align","right",3,"change"],["matInput","","placeholder","Amount","formControlName","amount",2,"text-align","right",3,"ngModel","readonly","ngModelChange"],[1,"modal-footer","d-flex","justify-content-right"],["mdbBtn","","color","deep-orange","mdbWavesEffect","",1,"waves-light",3,"click"],[3,"value"],["title","","data-toggle","tooltip","data-original-title","Edit",1,"edit",2,"cursor","pointer",3,"click"],[1,"routeIcon"],["title","","data-toggle","tooltip","data-original-title","Delete",1,"delete",2,"cursor","pointer",3,"click"],[3,"value","onSelectionChange"]],template:function(e,t){if(1&e){var i=d.Yb();d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Raw material order delivery "),d.Xb(8,"a",7),d.Xb(9,"mat-icon",8),d.Hc(10,"web"),d.Wb(),d.Wb(),d.Wb(),d.Gc(11,Ee,3,1,"div",9),d.Gc(12,Re,3,0,"div",9),d.Wb(),d.Xb(13,"div",10),d.Xb(14,"form",11,12),d.fc("ngSubmit",(function(){return t.onSubmit()})),d.Xb(16,"div",2),d.Xb(17,"div",13),d.Xb(18,"mat-form-field",14),d.Sb(19,"input",15),d.Xb(20,"input",16),d.fc("ngModelChange",(function(e){return t.isActive=e})),d.Wb(),d.Xb(21,"input",17),d.fc("ngModelChange",(function(e){return t.siteId=e})),d.Wb(),d.Wb(),d.Xb(22,"mat-form-field",18),d.Xb(23,"mat-select",19),d.fc("selectionChange",(function(e){return t.populateSupplierDetails(e)})),d.Gc(24,Te,2,2,"mat-option",20),d.Wb(),d.Gc(25,Ue,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(26,"div",13),d.Xb(27,"mat-form-field",18),d.Xb(28,"mat-select",21),d.Gc(29,Be,2,2,"mat-option",20),d.Wb(),d.Wb(),d.Wb(),d.Xb(30,"div",22),d.Xb(31,"mat-form-field",18),d.Sb(32,"input",23),d.Gc(33,Le,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(34,"div",22),d.Xb(35,"mat-form-field"),d.Xb(36,"mat-label"),d.Hc(37,"Bill Date"),d.Wb(),d.Sb(38,"input",24),d.Sb(39,"mat-datepicker-toggle",25),d.Sb(40,"mat-datepicker",null,26),d.Wb(),d.Wb(),d.Xb(42,"div",22),d.Xb(43,"mat-form-field",18),d.Sb(44,"input",27),d.Wb(),d.Wb(),d.Wb(),d.Xb(45,"div",2),d.Xb(46,"div",22),d.Xb(47,"mat-form-field",18),d.Xb(48,"input",28),d.fc("ngModelChange",(function(e){return t.headerAmount=e}))("change",(function(){return t.calculateHeader()})),d.Wb(),d.Gc(49,$e,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(50,"div",22),d.Xb(51,"mat-form-field",18),d.Xb(52,"input",29),d.fc("change",(function(){return t.calculateHeader()})),d.Wb(),d.Wb(),d.Wb(),d.Xb(53,"div",22),d.Xb(54,"mat-form-field",18),d.Xb(55,"input",30),d.fc("ngModelChange",(function(e){return t.cgstAmount=e})),d.Wb(),d.Wb(),d.Wb(),d.Xb(56,"div",22),d.Xb(57,"mat-form-field",18),d.Xb(58,"input",31),d.fc("ngModelChange",(function(e){return t.sgstAmount=e})),d.Wb(),d.Wb(),d.Wb(),d.Xb(59,"div",22),d.Xb(60,"mat-form-field",18),d.Xb(61,"input",32),d.fc("ngModelChange",(function(e){return t.totalAmount=e})),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(62,"div",2),d.Xb(63,"div",3),d.Xb(64,"div",4),d.Xb(65,"div",33),d.Xb(66,"table",34),d.Xb(67,"tr"),d.Xb(68,"td",35),d.Xb(69,"h4",6),d.Hc(70,"Order delivery details"),d.Wb(),d.Wb(),d.Xb(71,"td",36),d.Xb(72,"button",37),d.fc("click",(function(){return d.Ac(i),d.xc(96).show(),t.filterRawMaterials()})),d.Hc(73," Add "),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Sb(74,"p",38),d.Wb(),d.Xb(75,"div",10),d.Xb(76,"div",39),d.Xb(77,"table",40),d.Xb(78,"thead",41),d.Xb(79,"th"),d.Hc(80,"Product"),d.Wb(),d.Xb(81,"th"),d.Hc(82,"Quantity"),d.Wb(),d.Xb(83,"th"),d.Hc(84,"Unit"),d.Wb(),d.Xb(85,"th"),d.Hc(86,"Rate"),d.Wb(),d.Xb(87,"th"),d.Hc(88,"Amount"),d.Wb(),d.Xb(89,"th"),d.Hc(90,"Action"),d.Wb(),d.Wb(),d.Gc(91,Qe,13,6,"tbody",42),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(92,"button",43),d.fc("click",(function(){return d.Ac(i),d.xc(15).ngSubmit.emit()})),d.Hc(93,"Save"),d.Wb(),d.Sb(94,"div",44),d.Xb(95,"div",45,46),d.Xb(97,"div",47),d.Xb(98,"div",48),d.Xb(99,"div",49),d.Xb(100,"h4",50),d.Hc(101,"Project Detail Entry"),d.Wb(),d.Xb(102,"button",51),d.fc("click",(function(){d.Ac(i);var e=d.xc(96);return t.close(e)})),d.Xb(103,"span",52),d.Hc(104,"\xd7"),d.Wb(),d.Wb(),d.Wb(),d.Xb(105,"div",10),d.Xb(106,"form",53),d.Xb(107,"div",2),d.Xb(108,"div",54),d.Xb(109,"mat-form-field",14),d.Sb(110,"input",15),d.Sb(111,"input",55),d.Sb(112,"input",56),d.Wb(),d.Xb(113,"mat-form-field",14),d.Xb(114,"input",57),d.fc("ngModelChange",(function(e){return t.rmName=e})),d.Wb(),d.Wb(),d.Xb(115,"mat-form-field",18),d.Xb(116,"mat-select",58),d.Gc(117,_e,2,2,"mat-option",59),d.Wb(),d.Gc(118,Je,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(119,"div",22),d.Xb(120,"mat-form-field",14),d.Xb(121,"input",60),d.fc("ngModelChange",(function(e){return t.unitId=e})),d.Wb(),d.Wb(),d.Xb(122,"mat-form-field",18),d.Xb(123,"input",61),d.fc("ngModelChange",(function(e){return t.unitName=e})),d.Wb(),d.Gc(124,Ye,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(125,"div",22),d.Xb(126,"mat-form-field",18),d.Xb(127,"input",62),d.fc("change",(function(){return t.calculateDetail()})),d.Wb(),d.Gc(128,Ke,2,0,"mat-error",9),d.Gc(129,ze,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(130,"div",22),d.Xb(131,"mat-form-field",18),d.Xb(132,"input",63),d.fc("change",(function(){return t.calculateDetail()})),d.Wb(),d.Gc(133,Ze,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(134,"div",22),d.Xb(135,"mat-form-field",18),d.Xb(136,"input",64),d.fc("ngModelChange",(function(e){return t.detailAmount=e})),d.Wb(),d.Gc(137,et,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Wb(),d.Xb(138,"div",65),d.Xb(139,"button",66),d.fc("click",(function(){d.Ac(i);var e=d.xc(96);return t.onDetailSubmit(e)})),d.Hc(140,"Save"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=d.xc(15),r=d.xc(41);d.Cb(11),d.oc("ngIf",t.deliveryId),d.Cb(1),d.oc("ngIf",!t.deliveryId),d.Cb(2),d.oc("formGroup",t.deliveryForm),d.Cb(6),d.oc("ngModel",t.isActive),d.Cb(1),d.oc("ngModel",t.siteId),d.Cb(3),d.oc("ngForOf",t.suppliers),d.Cb(1),d.oc("ngIf",t.hasError("supplierId","required")),d.Cb(4),d.oc("ngForOf",t.supplierDetails),d.Cb(4),d.oc("ngIf",t.hasError("billNo","required")),d.Cb(5),d.oc("matDatepicker",r),d.Cb(1),d.oc("for",r),d.Cb(9),d.oc("ngModel",t.headerAmount)("readonly",!0),d.Cb(1),d.oc("ngIf",t.hasError("amount","required")),d.Cb(6),d.oc("readonly",!0)("ngModel",t.cgstAmount),d.Cb(3),d.oc("readonly",!0)("ngModel",t.sgstAmount),d.Cb(3),d.oc("readonly",!0)("ngModel",t.totalAmount),d.Cb(30),d.oc("ngForOf",t.details),d.Cb(1),d.oc("disabled",!a.form.valid),d.Cb(6),d.Fc("width",t.modalWIdth()),d.Cb(8),d.oc("formGroup",t.deliveryDetailsForm),d.Cb(8),d.oc("ngModel",t.rmName),d.Cb(3),d.oc("ngForOf",t.filteredRawMaterials),d.Cb(1),d.oc("ngIf",t.hasDetailError("rmId","required")),d.Cb(3),d.oc("ngModel",t.unitId),d.Cb(2),d.oc("readonly",!0)("ngModel",t.unitName),d.Cb(1),d.oc("ngIf",t.hasDetailError("unitName","required")),d.Cb(4),d.oc("ngIf",t.hasDetailError("quantity","required")),d.Cb(1),d.oc("ngIf",t.hasDetailError("quantity","lessThanValue")),d.Cb(4),d.oc("ngIf",t.hasDetailError("rate","required")),d.Cb(3),d.oc("ngModel",t.detailAmount)("readonly",!0),d.Cb(1),d.oc("ngIf",t.hasDetailError("amount","required"))}},directives:[n.e,g.a,r.l,o.p,o.l,o.f,W.c,X.b,o.a,o.k,o.d,y.a,r.k,W.f,I.b,I.d,W.g,I.a,C.b,C.c,D.l,W.b],styles:[""]}),tt),at=function(){return["/transaction/order-delivery/edit"]},rt=function(e){return{id:e}};function nt(e,t){if(1&e&&(d.Xb(0,"tbody"),d.Xb(1,"tr"),d.Xb(2,"td"),d.Hc(3),d.Wb(),d.Xb(4,"td"),d.Hc(5),d.Wb(),d.Xb(6,"td"),d.Hc(7),d.Wb(),d.Xb(8,"td"),d.Hc(9),d.Wb(),d.Xb(10,"td"),d.Hc(11),d.Wb(),d.Xb(12,"td"),d.Xb(13,"a",15),d.Xb(14,"mat-icon",16),d.Hc(15,"edit"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()),2&e){var i=t.$implicit;d.Cb(3),d.Ic(i.deliveryId),d.Cb(2),d.Ic(i.supplierName),d.Cb(2),d.Ic(i.billNo),d.Cb(2),d.Ic(i.billDateString),d.Cb(2),d.Ic(i.vehicleNo),d.Cb(2),d.oc("routerLink",d.qc(7,at))("queryParams",d.rc(8,rt,i.deliveryId))}}var ot,ct,lt=((ct=function(){function e(t,i,a){_classCallCheck(this,e),this.orderDeliveryService=t,this.notificationService=i,this.dialog=a,this.deliveries=[]}return _createClass(e,[{key:"ngOnInit",value:function(){this.findAll()}},{key:"findAll",value:function(){var e=this;this.orderDeliveryService.findAll().subscribe((function(t){e.deliveries=t}))}},{key:"delete",value:function(e){var t=this;this.orderDeliveryService.delete(e.deliveryId).subscribe((function(e){console.log("Delete Response >>>>"),console.log(e),t.notificationService.openSnackBar(e.message,e.status),t.findAll()}))}},{key:"openDialog",value:function(e){var t=this;this.dialog.open(l.a,{width:"250px",data:{header:"Confirm",content:"Are you sure to delete?"}}).afterClosed().subscribe((function(i){i&&t.delete(e)}))}},{key:"isMobileMenu",value:function(){return!($(window).width()>991)}}]),e}()).\u0275fac=function(e){return new(e||ct)(d.Rb(Pe),d.Rb(u.a),d.Rb(v.b))},ct.\u0275cmp=d.Lb({type:ct,selectors:[["app-order-delivery-show"]],decls:29,vars:1,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card","card-plain"],[1,"card-header","card-header-info"],[1,"card-title"],["routerLink","/transaction/order-delivery/add"],[1,"gridIcon"],[1,"card-category"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-hover"],[1,"text-primary"],[4,"ngFor","ngForOf"],["title","","data-toggle","tooltip","data-original-title","Edit",1,"edit",3,"routerLink","queryParams"],[1,"routeIcon"]],template:function(e,t){1&e&&(d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Purchase Order details "),d.Xb(8,"a",7),d.Xb(9,"mat-icon",8),d.Hc(10,"add"),d.Wb(),d.Wb(),d.Wb(),d.Sb(11,"p",9),d.Wb(),d.Xb(12,"div",10),d.Xb(13,"div",11),d.Xb(14,"table",12),d.Xb(15,"thead",13),d.Xb(16,"th"),d.Hc(17,"DL Code"),d.Wb(),d.Xb(18,"th"),d.Hc(19,"Supplier"),d.Wb(),d.Xb(20,"th"),d.Hc(21,"Bill No"),d.Wb(),d.Xb(22,"th"),d.Hc(23,"Bill Date"),d.Wb(),d.Xb(24,"th"),d.Hc(25,"Vehicle No"),d.Wb(),d.Xb(26,"th"),d.Hc(27,"Action"),d.Wb(),d.Wb(),d.Gc(28,nt,16,10,"tbody",14),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()),2&e&&(d.Cb(28),d.oc("ngForOf",t.deliveries))},directives:[n.e,g.a,r.k],styles:[""]}),ct),dt=((ot=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"save",value:function(e){return this.http.post("transaction/process",e)}},{key:"findAll",value:function(){return this.http.get("transaction/processes")}},{key:"findById",value:function(e){return this.http.get("transaction/processes/find",{params:{id:e.toString()}})}},{key:"delete",value:function(e){return this.http.delete("transaction/processes/delete",{params:{id:e.toString()}})}},{key:"deleteDetail",value:function(e,t){var i=new s.d;return i=(i=i.append("id",e.toString())).append("detailId",t.toString()),this.http.delete("transaction/processes/detail/delete",{params:i})}},{key:"findMaterialsByProjectIdAndSiteId",value:function(e,t){var i=new s.d;return i=(i=i.append("projectId",e)).append("siteId",t),this.http.get("transaction/processes/materials",{params:i})}}]),e}()).\u0275fac=function(e){return new(e||ot)(d.bc(s.b))},ot.\u0275prov=d.Nb({token:ot,factory:ot.\u0275fac,providedIn:"root"}),ot);function st(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Log date is required"),d.Wb())}function bt(e,t){if(1&e&&(d.Xb(0,"mat-option",62),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.projectId),d.Cb(1),d.Kc(" ",i.projectId," | ",i.description," ")}}function ut(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Project is required"),d.Wb())}function mt(e,t){if(1&e&&(d.Xb(0,"td"),d.Hc(1),d.Wb()),2&e){var i=d.ic().$implicit;d.Cb(1),d.Kc("",i.availableQuantity," ",i.materialUnitName,"")}}function ft(e,t){if(1&e&&(d.Xb(0,"td"),d.Hc(1),d.Wb()),2&e){var i=d.ic().$implicit;d.Cb(1),d.Kc("",i.remainingQuantity," ",i.materialUnitName,"")}}function pt(e,t){if(1&e){var i=d.Yb();d.Xb(0,"tbody"),d.Xb(1,"tr"),d.Xb(2,"td"),d.Hc(3),d.Wb(),d.Gc(4,mt,2,2,"td",21),d.Gc(5,ft,2,2,"td",21),d.Xb(6,"td"),d.Hc(7),d.Wb(),d.Xb(8,"td"),d.Hc(9),d.Wb(),d.Xb(10,"td"),d.Xb(11,"a",63),d.fc("click",(function(){d.Ac(i);var e=t.$implicit,a=d.ic(),r=d.xc(71);return a.editDetail(e,r)})),d.Xb(12,"mat-icon",64),d.Hc(13,"edit"),d.Wb(),d.Wb(),d.Xb(14,"a",65),d.fc("click",(function(){d.Ac(i);var e=t.$implicit;return d.ic().openDialog(e)})),d.Xb(15,"mat-icon",64),d.Hc(16,"delete"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=t.$implicit,r=d.ic();d.Cb(3),d.Ic(a.materialName),d.Cb(1),d.oc("ngIf",!r.isProductMat(a)),d.Cb(1),d.oc("ngIf",r.isProductMat(a)),d.Cb(2),d.Kc("",a.quantity," ",a.materialUnitName,""),d.Cb(2),d.Ic(a.processType)}}function ht(e,t){if(1&e&&(d.Xb(0,"mat-option",62),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.code),d.Cb(1),d.Jc(" ",i.name," ")}}function vt(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Material is required"),d.Wb())}function gt(e,t){if(1&e){var i=d.Yb();d.Xb(0,"div",17),d.Xb(1,"mat-form-field",23),d.Xb(2,"input",66),d.fc("ngModelChange",(function(e){return d.Ac(i),d.ic().availableQuantity=e})),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=d.ic();d.Cb(2),d.oc("readonly",!0)("ngModel",a.availableQuantity)}}function Wt(e,t){if(1&e){var i=d.Yb();d.Xb(0,"div",17),d.Xb(1,"mat-form-field",23),d.Xb(2,"input",67),d.fc("ngModelChange",(function(e){return d.Ac(i),d.ic().remainingQuantity=e})),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=d.ic();d.Cb(2),d.oc("readonly",!0)("ngModel",a.remainingQuantity)}}function Xt(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Quantity is required"),d.Wb())}function yt(e,t){if(1&e&&(d.Xb(0,"div",17),d.Xb(1,"mat-form-field",23),d.Sb(2,"input",68),d.Gc(3,Xt,2,0,"mat-error",21),d.Wb(),d.Wb()),2&e){var i=d.ic();d.Cb(3),d.oc("ngIf",i.hasDetailError("quantity","required"))}}function It(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Quantity is required"),d.Wb())}function Ct(e,t){1&e&&d.Sb(0,"mat-error")}function Dt(e,t){if(1&e&&(d.Xb(0,"div",17),d.Xb(1,"mat-form-field",23),d.Sb(2,"input",68),d.Gc(3,It,2,0,"mat-error",21),d.Gc(4,Ct,1,0,"mat-error",21),d.Wb(),d.Wb()),2&e){var i=d.ic();d.Cb(3),d.oc("ngIf",i.hasDetailError("quantity","required")),d.Cb(1),d.oc("ngIf",i.hasDetailError("quantity","mandatoryAndlessThanValue"))}}function St(e,t){if(1&e&&(d.Xb(0,"mat-option",62),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.clientId),d.Cb(1),d.Jc(" ",i.clientName," ")}}function kt(e,t){if(1&e&&(d.Xb(0,"mat-option",62),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.detailId),d.Cb(1),d.Jc(" ",i.identifier," ")}}var wt,Mt,Ft=((Mt=function(){function e(t,i,a,r,n,o,c,l){var d=this;_classCallCheck(this,e),this.orderProcessingService=t,this.projectService=i,this.dialog=a,this.route=r,this.notificationService=n,this.clientService=o,this.fb=c,this.datePipe=l,this.details=[],this.projects=[],this.projectMaterialList=[],this.workUnits=[{value:"DUMDUM",viewValue:"Dum dum unit"},{value:"SINGUR",viewValue:"Singur Unit"}],this.inOutValues=[{value:"IN",viewValue:"In"},{value:"OUT",viewValue:"Out"}],this.siteId="SINGUR",this.galvanisers=[],this.galvaniserDetails=[],this.hasError=function(e,t){return d.opForm.controls[e].hasError(t)},this.hasDetailError=function(e,t){return d.opDetailsForm.controls[e].hasError(t)}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.getProjects(),this.getGalvanisers(),this.opForm=this.fb.group({processId:new o.c(null),projectId:new o.c("",o.o.required),processDate:new o.c(null,o.o.required),processDateString:new o.c(""),notes:new o.c(""),siteId:new o.c(""),isActive:new o.c(!0),details:new o.c("")}),this.opDetailsForm=this.fb.group({processId:new o.c(null),processDetailsId:new o.c(null),processType:new o.c("",o.o.required),materialId:new o.c("",o.o.required),materialName:new o.c(""),materialUnit:new o.c("",o.o.required),materialUnitName:new o.c(""),quantity:new o.c(null,o.o.required),inOutFlag:new o.c(""),remainingQuantity:new o.c(0),availableQuantity:new o.c(0),notes:new o.c(""),materialType:new o.c(""),galvaniserId:new o.c(""),galvaniserDetailId:new o.c("")},{validator:[function(e){var t=e.controls.quantity,i=e.controls.availableQuantity,a=e.controls.remainingQuantity,r=e.controls.materialType,n=e.controls.processType;if(t.valid&&i.valid&&a.valid&&r.valid&&n.valid){if("P"==r.value&&t.value>a.value){var o=t+" should be less than or equal to remaining quantity";return t.setErrors({mandatoryAndlessThanValue:t}),{mandatoryAndlessThanValue:o}}if("R"==r.value&&t.value>i.value){var c=t+" should be less than or equal to available quantity";return t.setErrors({mandatoryAndlessThanValue:t}),{mandatoryAndlessThanValue:c}}if("S"==r.value&&"OUT"==n.value&&t.value>i.value){var l=t+" should be less than or equal to available quantity";return t.setErrors({mandatoryAndlessThanValue:t}),{mandatoryAndlessThanValue:l}}}return t.hasError("mandatoryAndlessThanValue")&&t.setErrors(null),null}]}),this.route.queryParams.subscribe((function(t){Object.keys(t).length>0&&e.orderProcessingService.findById(t.id).subscribe((function(t){e.details=t.details,t.processDate=Object(Oe.a)(t.processDateString),e.opForm.setValue(t)}))}))}},{key:"onSubmit",value:function(){var e=this;this.opForm.valid&&(this.orderProcessing=this.opForm.value,this.orderProcessing.details=this.details,null!=this.opForm.value.isActive&&""!=this.opForm.value.isActive||(this.orderProcessing.isActive=!0),null!=this.opForm.value.processDate&&(this.orderProcessing.processDateString=this.datePipe.transform(this.orderProcessing.processDate,"dd/MM/yyyy")),this.orderProcessingService.save(this.orderProcessing).subscribe((function(t){e.notificationService.openSnackBar(t.message,t.status),console.log("success response ::"),console.log(t),e.opForm.reset(),e.details=[]}),(function(t){e.notificationService.openSnackBar(t.error.message,t.error.status),console.log("error response ::"),console.log(t.message)})))}},{key:"onDetailSubmit",value:function(e){if(this.opDetailsForm.valid){var t,i=this.opDetailsForm.value,a=i.processId;t=this.details.findIndex(null!=a&&a>0?function(e){return e.processId==a}:function(e){return e.materialId==i.materialId}),console.log("last index >>"+t),-1!=t?(this.details[t]=this.opDetailsForm.value,this.notificationService.openSnackBar("Details updated successfully","success")):(this.details.push(this.opDetailsForm.value),this.notificationService.openSnackBar("Details added successfully","success")),this.opDetailsForm.reset(),e.hide()}else this.notificationService.openSnackBar("Error occurred, please review and submit again","danger")}},{key:"close",value:function(e){this.opDetailsForm.reset(),e.hide()}},{key:"editDetail",value:function(e,t){this.opDetailsForm.patchValue(e),this.populateDetailForm(e.materialId),t.show()}},{key:"openDialog",value:function(e){var t=this;this.dialog.open(l.a,{width:"250px",data:{header:"Confirm",content:"Are you sure to delete?"}}).afterClosed().subscribe((function(i){i&&t.deleteDetail(e)}))}},{key:"deleteDetail",value:function(e){var t=this,i=this.calculateDetailIndex(e);e.processDetailsId?this.orderProcessingService.deleteDetail(e.processId,e.processDetailsId).subscribe((function(e){t.details.splice(i,1),t.notificationService.openSnackBar(e.message,e.status)}),(function(e){t.notificationService.openSnackBar(e.error.message,e.error.status),console.log("error response ::"),console.log(e.message)})):-1!==i&&(this.details.splice(i,1),this.notificationService.openSnackBar("Details removed successfully","success"))}},{key:"calculateDetailIndex",value:function(e){return this.details.findIndex(null!=e.processDetailsId?function(t){return t.processDetailsId==e.processDetailsId}:function(t){return t.materialId==e.materialId})}},{key:"getProjects",value:function(){var e=this;this.projectService.findAll().subscribe((function(t){e.projects=t}))}},{key:"populatDetailLists",value:function(e){var t=this;this.orderProcessingService.findMaterialsByProjectIdAndSiteId(e.value,this.siteId).subscribe((function(e){t.projectMaterialList=e}))}},{key:"populateRow",value:function(e){this.populateDetailForm(e.value)}},{key:"populateDetailForm",value:function(e){var t=this.projectMaterialList.filter((function(t){return t.code==e}))[0];this.materialId=t.code,this.materialName=t.name,this.materialType=t.type,this.materialUnit=t.unitId,this.materialUnitName=t.unitName,this.availableQuantity=t.availableQuantity,this.remainingQuantity=t.remainingQuantity,"P"==this.materialType&&(this.processType="IN"),"R"==this.materialType&&(this.processType="OUT")}},{key:"isProduct",value:function(e){return"P"==e}},{key:"isSemiProduct",value:function(e){return"S"==e}},{key:"isProductMat",value:function(e){return"P"==e.materialType}},{key:"isMobileMenu",value:function(){return!($(window).width()>991)}},{key:"modalWIdth",value:function(){return this.isMobileMenu()?"100%":"150%"}},{key:"getGalvanisers",value:function(){var e=this;this.clientService.findAll().subscribe((function(t){e.galvanisers=t}))}},{key:"populateGalvaniserDetails",value:function(e){this.filterGalvaniserDateils(e.value)}},{key:"filterGalvaniserDateils",value:function(e){console.log(e),this.galvaniserDetails=this.galvanisers.filter((function(t){return t.clientId===e}))[0].details}}]),e}()).\u0275fac=function(e){return new(e||Mt)(d.Rb(dt),d.Rb(p.a),d.Rb(v.b),d.Rb(n.a),d.Rb(u.a),d.Rb(f.a),d.Rb(o.b),d.Rb(r.d))},Mt.\u0275cmp=d.Lb({type:Mt,selectors:[["app-order-processing"]],decls:116,vars:27,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header","card-header-success"],[1,"card-title"],["routerLink","/transaction/logs"],[1,"gridIcon"],[1,"card-category"],[1,"card-body"],[3,"formGroup","ngSubmit"],["headerForm","ngForm"],[1,"invisible","example-full-width"],["matInput","","placeholder","processId","formControlName","processId"],["matInput","","placeholder","isActive","formControlName","isActive"],["matInput","","placeholder","siteId","formControlName","siteId",3,"ngModel","ngModelChange"],[1,"col-md-2"],["matInput","","formControlName","processDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker3",""],[4,"ngIf"],[1,"col-md-3"],[1,"example-full-width"],["placeholder","Project","formControlName","projectId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-5"],["matInput","","placeholder","Notes","formControlName","notes"],[1,"card","card-plain"],[1,"card-header","card-header-info"],["width","100%"],["width","90%"],[2,"align-content","justify-content-right"],["type","button","mdbBtn","","color","unique","rounded","true","data-toggle","modal","data-target","#basicExample","mdbWavesEffect","",3,"click"],[1,"table-responsive"],[1,"table","table-hover"],[1,"text-primary"],[4,"ngFor","ngForOf"],["mat-raised-button","","type","submit",1,"btn","btn-success","pull-right",3,"disabled","click"],[1,"clearfix"],["mdbModal","","id","frameModalTop","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade","left"],["frame","mdbModal"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","text-center"],[1,"modal-title","w-100","font-weight-bold"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[3,"formGroup"],[1,"col-md-4"],["matInput","","placeholder","processDetailsId","formControlName","processDetailsId"],["matInput","","placeholder","materialType","formControlName","materialType",3,"ngModel","ngModelChange"],["matInput","","placeholder","materialName","formControlName","materialName",3,"ngModel","ngModelChange"],["placeholder","Material","formControlName","materialId",3,"selectionChange"],["matInput","","placeholder","Unit","formControlName","materialUnit",3,"ngModel","ngModelChange"],["matInput","","placeholder","Unit","formControlName","materialUnitName",3,"readonly","ngModel","ngModelChange"],["class","col-md-2",4,"ngIf"],["matInput","","placeholder","In/Out","formControlName","processType",3,"readonly","ngModel","ngModelChange"],["placeholder","Galvaniser","formControlName","galvaniserId",3,"selectionChange"],["placeholder","Galvaniser Address","formControlName","galvaniserDetailId"],[1,"modal-footer","d-flex","justify-content-right"],["mdbBtn","","color","deep-orange","mdbWavesEffect","",1,"waves-light",3,"click"],[3,"value"],["title","","data-toggle","tooltip","data-original-title","Edit",1,"edit",2,"cursor","pointer",3,"click"],[1,"routeIcon"],["title","","data-toggle","tooltip","data-original-title","Delete",1,"delete",2,"cursor","pointer",3,"click"],["matInput","","placeholder","Available Quantity","formControlName","availableQuantity",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","Remaining Quantity","formControlName","remainingQuantity",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","Quantity","formControlName","quantity",2,"text-align","right"]],template:function(e,t){if(1&e){var i=d.Yb();d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Production Record "),d.Xb(8,"a",7),d.Xb(9,"mat-icon",8),d.Hc(10,"web"),d.Wb(),d.Wb(),d.Wb(),d.Xb(11,"p",9),d.Hc(12,"Send to Galvanization and rasw raw material consumtion record update"),d.Wb(),d.Wb(),d.Xb(13,"div",10),d.Xb(14,"form",11,12),d.fc("ngSubmit",(function(){return t.onSubmit()})),d.Xb(16,"div",2),d.Xb(17,"div"),d.Xb(18,"mat-form-field",13),d.Sb(19,"input",14),d.Sb(20,"input",15),d.Xb(21,"input",16),d.fc("ngModelChange",(function(e){return t.siteId=e})),d.Wb(),d.Wb(),d.Wb(),d.Xb(22,"div",17),d.Xb(23,"mat-form-field"),d.Xb(24,"mat-label"),d.Hc(25,"Log Date"),d.Wb(),d.Sb(26,"input",18),d.Sb(27,"mat-datepicker-toggle",19),d.Sb(28,"mat-datepicker",null,20),d.Gc(30,st,2,0,"mat-error",21),d.Wb(),d.Wb(),d.Xb(31,"div",22),d.Xb(32,"mat-form-field",23),d.Xb(33,"mat-select",24),d.fc("selectionChange",(function(e){return t.populatDetailLists(e)})),d.Gc(34,bt,2,3,"mat-option",25),d.Wb(),d.Gc(35,ut,2,0,"mat-error",21),d.Wb(),d.Wb(),d.Xb(36,"div",26),d.Xb(37,"mat-form-field",23),d.Sb(38,"input",27),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(39,"div",2),d.Xb(40,"div",3),d.Xb(41,"div",28),d.Xb(42,"div",29),d.Xb(43,"table",30),d.Xb(44,"tr"),d.Xb(45,"td",31),d.Xb(46,"h4",6),d.Hc(47,"Daily work log Dteails"),d.Wb(),d.Wb(),d.Xb(48,"td",32),d.Xb(49,"button",33),d.fc("click",(function(){return d.Ac(i),d.xc(71).show()})),d.Hc(50," Add "),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Sb(51,"p",9),d.Wb(),d.Xb(52,"div",10),d.Xb(53,"div",34),d.Xb(54,"table",35),d.Xb(55,"thead",36),d.Xb(56,"th"),d.Hc(57,"Material"),d.Wb(),d.Xb(58,"th"),d.Hc(59,"Available / Remaining Quantity"),d.Wb(),d.Xb(60,"th"),d.Hc(61,"Processed Quantity"),d.Wb(),d.Xb(62,"th"),d.Hc(63,"Movement"),d.Wb(),d.Xb(64,"th"),d.Hc(65,"Action"),d.Wb(),d.Wb(),d.Gc(66,pt,17,6,"tbody",37),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(67,"button",38),d.fc("click",(function(){return d.Ac(i),d.xc(15).ngSubmit.emit()})),d.Hc(68,"Save"),d.Wb(),d.Sb(69,"div",39),d.Xb(70,"div",40,41),d.Xb(72,"div",42),d.Xb(73,"div",43),d.Xb(74,"div",44),d.Xb(75,"h4",45),d.Hc(76,"Add/Update Work Log"),d.Wb(),d.Xb(77,"button",46),d.fc("click",(function(){d.Ac(i);var e=d.xc(71);return t.close(e)})),d.Xb(78,"span",47),d.Hc(79,"\xd7"),d.Wb(),d.Wb(),d.Wb(),d.Xb(80,"div",10),d.Xb(81,"form",48),d.Xb(82,"div",2),d.Xb(83,"div",49),d.Xb(84,"mat-form-field",13),d.Sb(85,"input",14),d.Sb(86,"input",50),d.Xb(87,"input",51),d.fc("ngModelChange",(function(e){return t.materialType=e})),d.Wb(),d.Xb(88,"input",52),d.fc("ngModelChange",(function(e){return t.materialName=e})),d.Wb(),d.Wb(),d.Xb(89,"mat-form-field",23),d.Xb(90,"mat-select",53),d.fc("selectionChange",(function(e){return t.populateRow(e)})),d.Gc(91,ht,2,2,"mat-option",25),d.Wb(),d.Gc(92,vt,2,0,"mat-error",21),d.Wb(),d.Wb(),d.Xb(93,"div",17),d.Xb(94,"mat-form-field",13),d.Xb(95,"input",54),d.fc("ngModelChange",(function(e){return t.materialUnit=e})),d.Wb(),d.Wb(),d.Xb(96,"mat-form-field",23),d.Xb(97,"input",55),d.fc("ngModelChange",(function(e){return t.materialUnitName=e})),d.Wb(),d.Wb(),d.Wb(),d.Gc(98,gt,3,2,"div",56),d.Gc(99,Wt,3,2,"div",56),d.Gc(100,yt,4,1,"div",56),d.Gc(101,Dt,5,2,"div",56),d.Xb(102,"div",17),d.Xb(103,"mat-form-field",23),d.Xb(104,"input",57),d.fc("ngModelChange",(function(e){return t.processType=e})),d.Wb(),d.Wb(),d.Wb(),d.Xb(105,"div",22),d.Xb(106,"mat-form-field",23),d.Xb(107,"mat-select",58),d.fc("selectionChange",(function(e){return t.populateGalvaniserDetails(e)})),d.Gc(108,St,2,2,"mat-option",25),d.Wb(),d.Wb(),d.Wb(),d.Xb(109,"div",22),d.Xb(110,"mat-form-field",23),d.Xb(111,"mat-select",59),d.Gc(112,kt,2,2,"mat-option",25),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(113,"div",60),d.Xb(114,"button",61),d.fc("click",(function(){d.Ac(i);var e=d.xc(71);return t.onDetailSubmit(e)})),d.Hc(115,"Save"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=d.xc(15),r=d.xc(29);d.Cb(14),d.oc("formGroup",t.opForm),d.Cb(7),d.oc("ngModel",t.siteId),d.Cb(5),d.oc("matDatepicker",r),d.Cb(1),d.oc("for",r),d.Cb(3),d.oc("ngIf",t.hasError("processDate","required")),d.Cb(4),d.oc("ngForOf",t.projects),d.Cb(1),d.oc("ngIf",t.hasError("projectId","required")),d.Cb(31),d.oc("ngForOf",t.details),d.Cb(1),d.oc("disabled",!a.form.valid),d.Cb(6),d.Fc("width",t.modalWIdth()),d.Cb(8),d.oc("formGroup",t.opDetailsForm),d.Cb(6),d.oc("ngModel",t.materialType),d.Cb(1),d.oc("ngModel",t.materialName),d.Cb(3),d.oc("ngForOf",t.projectMaterialList),d.Cb(1),d.oc("ngIf",t.hasDetailError("materialId","required")),d.Cb(3),d.oc("ngModel",t.materialUnit),d.Cb(2),d.oc("readonly",!0)("ngModel",t.materialUnitName),d.Cb(1),d.oc("ngIf",!t.isProduct(t.materialType)),d.Cb(1),d.oc("ngIf",t.isProduct(t.materialType)),d.Cb(1),d.oc("ngIf",t.isProduct(t.materialType)),d.Cb(1),d.oc("ngIf",!t.isProduct(t.materialType)),d.Cb(3),d.oc("readonly",!0)("ngModel",t.processType),d.Cb(4),d.oc("ngForOf",t.galvanisers),d.Cb(4),d.oc("ngForOf",t.galvaniserDetails)}},directives:[n.e,g.a,o.p,o.l,o.f,W.c,X.b,o.a,o.k,o.d,W.f,I.b,I.d,W.g,I.a,r.l,y.a,r.k,C.b,C.c,W.b,D.l],styles:[""]}),Mt),Ht=((wt=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"findAllByDate",value:function(e,t){var i=new s.d;return i=(i=i.set("logDate",e)).append("toDate",t),this.http.get("transaction/processes/date",{params:i})}}]),e}()).\u0275fac=function(e){return new(e||wt)(d.bc(s.b))},wt.\u0275prov=d.Nb({token:wt,factory:wt.\u0275fac,providedIn:"root"}),wt);function Nt(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Log date is required"),d.Wb())}function xt(e,t){if(1&e&&(d.Xb(0,"tbody"),d.Xb(1,"tr"),d.Xb(2,"td"),d.Hc(3),d.Wb(),d.Xb(4,"td"),d.Hc(5),d.Wb(),d.Xb(6,"td"),d.Hc(7),d.Wb(),d.Xb(8,"td"),d.Hc(9),d.Wb(),d.Wb(),d.Wb()),2&e){var i=t.$implicit;d.Cb(3),d.Ic(i.value.materialName),d.Cb(2),d.Kc("",i.value.quantity," ",i.value.materialUnit,""),d.Cb(2),d.Ic(i.value.galvaniserName),d.Cb(2),d.Ic(i.value.processType)}}function At(e,t){if(1&e&&(d.Xb(0,"div"),d.Xb(1,"h5",22),d.Hc(2),d.Wb(),d.Xb(3,"table",24),d.Xb(4,"thead",25),d.Xb(5,"th"),d.Hc(6,"Item"),d.Wb(),d.Xb(7,"th"),d.Hc(8,"Quantity"),d.Wb(),d.Xb(9,"th"),d.Hc(10,"Galvaniser"),d.Wb(),d.Xb(11,"th"),d.Hc(12,"In/Out"),d.Wb(),d.Wb(),d.Gc(13,xt,10,5,"tbody",23),d.jc(14,"keyvalue"),d.Wb(),d.Wb()),2&e){var i=t.$implicit;d.Cb(2),d.Jc("Date : ",i.key,""),d.Cb(11),d.oc("ngForOf",d.kc(14,2,i.value))}}function jt(e,t){if(1&e&&(d.Xb(0,"div",21),d.Xb(1,"h4",22),d.Xb(2,"b"),d.Hc(3),d.Wb(),d.Wb(),d.Gc(4,At,15,4,"div",23),d.jc(5,"keyvalue"),d.Wb()),2&e){var i=t.$implicit;d.Cb(3),d.Jc("Project id : ",i.key,""),d.Cb(1),d.oc("ngForOf",d.kc(5,2,i.value))}}var qt,Gt,Ot=((qt=function(){function e(t,i,a,r,n){var o=this;_classCallCheck(this,e),this.orderProcessingService=t,this.orderProcessingShowService=i,this.fb=a,this.dialog=r,this.datePipe=n,this.processes=[],this.toDateString="",this.hasError=function(e,t){return o.opForm.controls[e].hasError(t)}}return _createClass(e,[{key:"ngOnInit",value:function(){this.opForm=this.fb.group({processDate:new o.c(null,o.o.required),processDateString:new o.c(""),toDate:new o.c(null),toDateString:new o.c("")})}},{key:"findAll",value:function(){var e=this;this.orderProcessingService.findAll().subscribe((function(t){e.processes=t}))}},{key:"onSubmit",value:function(){var e=this;this.opForm.valid&&(this.processDate=this.opForm.value.processDate,this.toDate=this.opForm.value.toDate,null!=this.opForm.value.processDate&&(this.processDateString=this.datePipe.transform(this.processDate,"dd/MM/yyyy")),null!=this.opForm.value.toDate&&(this.toDateString=this.datePipe.transform(this.toDate,"dd/MM/yyyy")),this.orderProcessingShowService.findAllByDate(this.processDateString,this.toDateString).subscribe((function(t){e.works=t})),console.log(this.works))}}]),e}()).\u0275fac=function(e){return new(e||qt)(d.Rb(dt),d.Rb(Ht),d.Rb(o.b),d.Rb(v.b),d.Rb(r.d))},qt.\u0275cmp=d.Lb({type:qt,selectors:[["app-order-processing-show"]],decls:38,vars:10,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card","card-plain"],[1,"card-header","card-header-info"],[1,"card-title"],["routerLink","/transaction/log/add"],[1,"gridIcon"],[1,"card-body"],[3,"formGroup","ngSubmit"],["headerForm","ngForm"],[1,"col-md-2"],["matInput","","formControlName","processDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker3",""],[4,"ngIf"],["matInput","","formControlName","toDate",3,"matDatepicker"],["picker2",""],["mat-raised-button","","type","submit",1,"btn","btn-success","pull-right",3,"disabled","click"],["class","table-responsive",4,"ngFor","ngForOf"],[1,"table-responsive"],[1,"text-primary"],[4,"ngFor","ngForOf"],[1,"table","table-striped","table-sm"],[1,"thead-dark"]],template:function(e,t){if(1&e){var i=d.Yb();d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Daily work log "),d.Xb(8,"a",7),d.Xb(9,"mat-icon",8),d.Hc(10,"add"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(11,"div",9),d.Xb(12,"form",10,11),d.fc("ngSubmit",(function(){return t.onSubmit()})),d.Xb(14,"div",2),d.Xb(15,"div",12),d.Xb(16,"mat-form-field"),d.Xb(17,"mat-label"),d.Hc(18,"Log Date"),d.Wb(),d.Sb(19,"input",13),d.Sb(20,"mat-datepicker-toggle",14),d.Sb(21,"mat-datepicker",null,15),d.Gc(23,Nt,2,0,"mat-error",16),d.Wb(),d.Wb(),d.Xb(24,"div",12),d.Xb(25,"mat-form-field"),d.Xb(26,"mat-label"),d.Hc(27,"To Date"),d.Wb(),d.Sb(28,"input",17),d.Sb(29,"mat-datepicker-toggle",14),d.Sb(30,"mat-datepicker",null,18),d.Wb(),d.Wb(),d.Xb(32,"div",12),d.Xb(33,"button",19),d.fc("click",(function(){return d.Ac(i),d.xc(13).ngSubmit.emit()})),d.Hc(34,"Search"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(35,"div",9),d.Gc(36,jt,6,4,"div",20),d.jc(37,"keyvalue"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=d.xc(13),r=d.xc(22),n=d.xc(31);d.Cb(12),d.oc("formGroup",t.opForm),d.Cb(7),d.oc("matDatepicker",r),d.Cb(1),d.oc("for",r),d.Cb(3),d.oc("ngIf",t.hasError("processDate","required")),d.Cb(5),d.oc("matDatepicker",n),d.Cb(1),d.oc("for",n),d.Cb(4),d.oc("disabled",!a.form.valid),d.Cb(3),d.oc("ngForOf",d.kc(37,8,t.works))}},directives:[n.e,g.a,o.p,o.l,o.f,W.c,W.f,X.b,o.a,I.b,o.k,o.d,I.d,W.g,I.a,r.l,r.k,W.b],pipes:[r.f],styles:[""]}),qt),Pt=i("BPD/"),Et=((Gt=function(){function e(t,i){_classCallCheck(this,e),this.http=t,this.errorHandler=i}return _createClass(e,[{key:"save",value:function(e){return this.http.post("transaction/expense",e)}},{key:"findAll",value:function(){return this.http.get("transaction/expenses")}},{key:"delete",value:function(e){return this.http.delete("transaction/expense/"+e)}},{key:"findAllByDate",value:function(e){var t=new s.d;return t=t.set("expenseDate",e),this.http.get("transaction/expense/date",{params:t})}},{key:"getAllExpenseCategories",value:function(){return this.http.get("transaction/categories")}},{key:"findExpensesBetweenDates",value:function(e,t){var i=new s.d;return i=(i=i.append("expenseDate",e)).append("toDate",t),this.http.get("transaction/expense/report",{params:i})}}]),e}()).\u0275fac=function(e){return new(e||Gt)(d.bc(s.b),d.bc(Pt.a))},Gt.\u0275prov=d.Nb({token:Gt,factory:Gt.\u0275fac,providedIn:"root"}),Gt);function Rt(e,t){if(1&e&&(d.Xb(0,"mat-option",29),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.categoryId),d.Cb(1),d.Jc(" ",i.categoryName," ")}}function Tt(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Description is required"),d.Wb())}function Ut(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Amount is required "),d.Wb())}function Bt(e,t){if(1&e&&(d.Xb(0,"tbody"),d.Xb(1,"tr"),d.Xb(2,"td"),d.Hc(3),d.Wb(),d.Xb(4,"td"),d.Hc(5),d.Wb(),d.Xb(6,"td"),d.Hc(7),d.Wb(),d.Xb(8,"td"),d.Hc(9),d.Wb(),d.Wb(),d.Wb()),2&e){var i=t.$implicit;d.Cb(3),d.Ic(i.expenseDateString),d.Cb(2),d.Ic(i.categoryName),d.Cb(2),d.Ic(i.description),d.Cb(2),d.Ic(i.amount)}}var Lt,$t=((Lt=function(){function e(t,i,a){var r=this;_classCallCheck(this,e),this.expenseService=t,this.notificationService=i,this.datePipe=a,this.hasError=function(e,t){return r.exForm.controls[e].hasError(t)}}return _createClass(e,[{key:"ngOnInit",value:function(){this.getAllCategories(),this.exForm=new o.e({expenseDate:new o.c(null,o.o.required),expenseDateString:new o.c(""),description:new o.c("",o.o.required),amount:new o.c(0,o.o.required),categoryId:new o.c("",o.o.required)})}},{key:"onSubmit",value:function(){var e=this;this.exForm.valid&&(this.expense=this.exForm.value,console.log(this.expense),null!=this.exForm.value.expenseDate&&(this.expense.expenseDateString=this.datePipe.transform(this.expense.expenseDate,"dd/MM/yyyy")),this.expenseService.save(this.expense).subscribe((function(t){e.notificationService.openSnackBar(t.message,t.status),e.findAllByDate(e.expense.expenseDateString),e.exForm.value.description="",e.exForm.value.amount=0}),(function(t){e.notificationService.openSnackBar(t.error.message,t.error.status),console.log("error response ::"),console.log(t.message)})))}},{key:"findAll",value:function(){var e=this;this.expenseService.findAll().subscribe((function(t){e.expenses=t}))}},{key:"findAllByDate",value:function(e){var t=this;this.expenseService.findAllByDate(e).subscribe((function(e){t.expenses=e}))}},{key:"getAllCategories",value:function(){var e=this;this.expenseService.getAllExpenseCategories().subscribe((function(t){e.expenseCategories=t}))}}]),e}()).\u0275fac=function(e){return new(e||Lt)(d.Rb(Et),d.Rb(u.a),d.Rb(r.d))},Lt.\u0275cmp=d.Lb({type:Lt,selectors:[["app-expense"]],decls:56,vars:7,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header","card-header-success"],[1,"card-title"],[1,"card-category"],[1,"card-body"],[3,"formGroup"],[1,"col-md-2"],["matInput","","formControlName","expenseDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker1",""],[1,"example-full-width"],["placeholder","Category","formControlName","categoryId"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-3"],["matInput","","placeholder","Description","formControlName","description"],[4,"ngIf"],["matInput","","placeholder","Amount","formControlName","amount",2,"text-align","right"],["mat-raised-button","","type","submit",1,"btn","btn-success","pull-right",3,"click"],[1,"clearfix"],[1,"card","card-plain"],[1,"card-header","card-header-info"],[1,"table-responsive"],[1,"table","table-hover"],[1,"text-primary"],[4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){if(1&e&&(d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Create Expense Record"),d.Wb(),d.Xb(8,"p",7),d.Hc(9,"Declere expenses here"),d.Wb(),d.Wb(),d.Xb(10,"div",8),d.Xb(11,"form",9),d.Xb(12,"div",2),d.Xb(13,"div",10),d.Xb(14,"mat-form-field"),d.Xb(15,"mat-label"),d.Hc(16,"Expense Date"),d.Wb(),d.Sb(17,"input",11),d.Sb(18,"mat-datepicker-toggle",12),d.Sb(19,"mat-datepicker",null,13),d.Wb(),d.Wb(),d.Xb(21,"div",10),d.Xb(22,"mat-form-field",14),d.Xb(23,"mat-select",15),d.Gc(24,Rt,2,2,"mat-option",16),d.Wb(),d.Wb(),d.Wb(),d.Xb(25,"div",17),d.Xb(26,"mat-form-field",14),d.Sb(27,"input",18),d.Gc(28,Tt,2,0,"mat-error",19),d.Wb(),d.Wb(),d.Xb(29,"div",10),d.Xb(30,"mat-form-field",14),d.Sb(31,"input",20),d.Gc(32,Ut,2,0,"mat-error",19),d.Wb(),d.Wb(),d.Wb(),d.Xb(33,"button",21),d.fc("click",(function(){return t.onSubmit()})),d.Hc(34,"Save"),d.Wb(),d.Sb(35,"div",22),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(36,"div",2),d.Xb(37,"div",3),d.Xb(38,"div",23),d.Xb(39,"div",24),d.Xb(40,"h4",6),d.Hc(41,"Expenses"),d.Wb(),d.Sb(42,"p",7),d.Wb(),d.Xb(43,"div",8),d.Xb(44,"div",25),d.Xb(45,"table",26),d.Xb(46,"thead",27),d.Xb(47,"th"),d.Hc(48,"Date"),d.Wb(),d.Xb(49,"th"),d.Hc(50,"Category"),d.Wb(),d.Xb(51,"th"),d.Hc(52,"Description"),d.Wb(),d.Xb(53,"th"),d.Hc(54,"Amount"),d.Wb(),d.Wb(),d.Gc(55,Bt,10,4,"tbody",28),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()),2&e){var i=d.xc(20);d.Cb(11),d.oc("formGroup",t.exForm),d.Cb(6),d.oc("matDatepicker",i),d.Cb(1),d.oc("for",i),d.Cb(6),d.oc("ngForOf",t.expenseCategories),d.Cb(4),d.oc("ngIf",t.hasError("description","required")),d.Cb(4),d.oc("ngIf",t.hasError("amount","required")),d.Cb(23),d.oc("ngForOf",t.expenses)}},directives:[o.p,o.l,o.f,W.c,W.f,X.b,o.a,I.b,o.k,o.d,I.d,W.g,I.a,y.a,r.k,r.l,D.l,W.b],styles:[""]}),Lt);function Vt(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"From date is required"),d.Wb())}function Qt(e,t){if(1&e&&(d.Xb(0,"div",23),d.Xb(1,"table",24),d.Xb(2,"tbody"),d.Xb(3,"tr",20),d.Xb(4,"td",27),d.Xb(5,"b"),d.Hc(6),d.Wb(),d.Wb(),d.Xb(7,"td",28),d.Hc(8),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()),2&e){var i=t.$implicit;d.Cb(6),d.Ic(i.key),d.Cb(2),d.Ic(i.value)}}function _t(e,t){if(1&e&&(d.Xb(0,"tbody"),d.Xb(1,"tr"),d.Xb(2,"td"),d.Hc(3),d.Wb(),d.Xb(4,"td"),d.Hc(5),d.Wb(),d.Xb(6,"td"),d.Hc(7),d.Wb(),d.Xb(8,"td"),d.Hc(9),d.Wb(),d.Wb(),d.Wb()),2&e){var i=t.$implicit;d.Cb(3),d.Ic(i.expenseDateString),d.Cb(2),d.Ic(i.categoryName),d.Cb(2),d.Ic(i.description),d.Cb(2),d.Ic(i.amount)}}function Jt(e,t){if(1&e&&(d.Xb(0,"div"),d.Xb(1,"h5",20),d.Xb(2,"b"),d.Hc(3),d.Wb(),d.Wb(),d.Xb(4,"h5",20),d.Xb(5,"b"),d.Hc(6,"Expanse Summary :"),d.Wb(),d.Wb(),d.Xb(7,"div",21),d.Xb(8,"div",9),d.Gc(9,Qt,9,2,"div",22),d.jc(10,"keyvalue"),d.Wb(),d.Wb(),d.Xb(11,"h4",20),d.Xb(12,"b"),d.Hc(13,"Expanse Details :"),d.Wb(),d.Wb(),d.Xb(14,"div",9),d.Xb(15,"div",23),d.Xb(16,"table",24),d.Xb(17,"thead",25),d.Xb(18,"th"),d.Hc(19,"Date"),d.Wb(),d.Xb(20,"th"),d.Hc(21,"Category"),d.Wb(),d.Xb(22,"th"),d.Hc(23,"Description"),d.Wb(),d.Xb(24,"th"),d.Hc(25,"Amount"),d.Wb(),d.Wb(),d.Gc(26,_t,10,4,"tbody",26),d.Wb(),d.Wb(),d.Wb(),d.Wb()),2&e){var i=d.ic();d.Cb(3),d.Jc("Expanse during this date range : ",i.totalExpense,""),d.Cb(6),d.oc("ngForOf",d.kc(10,3,i.catagoriseExpenses)),d.Cb(17),d.oc("ngForOf",i.expenses)}}var Yt,Kt,zt=((Kt=function(){function e(t,i,a){var r=this;_classCallCheck(this,e),this.fb=t,this.expenseService=i,this.datePipe=a,this.fromDateString="",this.toDateString="",this.expenses=[],this.isSearched=!1,this.hasError=function(e,t){return r.expForm.controls[e].hasError(t)}}return _createClass(e,[{key:"ngOnInit",value:function(){this.expForm=this.fb.group({fromDate:new o.c(null,o.o.required),fromDateString:new o.c(""),toDate:new o.c(null),toDateString:new o.c("")})}},{key:"onSubmit",value:function(){var e=this;this.expForm.valid&&(this.fromDate=this.expForm.value.fromDate,this.toDate=this.expForm.value.toDate,null!=this.expForm.value.fromDate&&(this.fromDateString=this.datePipe.transform(this.fromDate,"dd/MM/yyyy")),null!=this.expForm.value.toDate&&(this.toDateString=this.datePipe.transform(this.toDate,"dd/MM/yyyy")),this.expenseService.findExpensesBetweenDates(this.fromDateString,this.toDateString).subscribe((function(t){e.summary=t,e.totalExpense=t.totalExpense,e.expenses=e.summary.details,e.catagoriseExpenses=e.summary.catagorisedExpenses})),console.log(this.expenses),this.isSearched=!0)}}]),e}()).\u0275fac=function(e){return new(e||Kt)(d.Rb(o.b),d.Rb(Et),d.Rb(r.d))},Kt.\u0275cmp=d.Lb({type:Kt,selectors:[["app-expense-show"]],decls:36,vars:8,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card","card-plain"],[1,"card-header","card-header-info"],[1,"card-title"],["routerLink","/transaction/expense/add"],[1,"gridIcon"],[1,"card-body"],[3,"formGroup","ngSubmit"],["headerForm","ngForm"],[1,"col-md-2"],["matInput","","formControlName","fromDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker1",""],[4,"ngIf"],["matInput","","formControlName","toDate",3,"matDatepicker"],["picker2",""],["mat-raised-button","","type","submit",1,"btn","btn-success","pull-right",3,"disabled","click"],[1,"text-primary"],[1,"col-md-4"],["class","table-responsive",4,"ngFor","ngForOf"],[1,"table-responsive"],[1,"table","table-striped","table-sm"],[1,"thead-dark"],[4,"ngFor","ngForOf"],[1,"col"],[1,"col","text-right"]],template:function(e,t){if(1&e){var i=d.Yb();d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Expense details "),d.Xb(8,"a",7),d.Xb(9,"mat-icon",8),d.Hc(10,"add"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(11,"div",9),d.Xb(12,"form",10,11),d.fc("ngSubmit",(function(){return t.onSubmit()})),d.Xb(14,"div",2),d.Xb(15,"div",12),d.Xb(16,"mat-form-field"),d.Xb(17,"mat-label"),d.Hc(18,"From Date/Expanse Date"),d.Wb(),d.Sb(19,"input",13),d.Sb(20,"mat-datepicker-toggle",14),d.Sb(21,"mat-datepicker",null,15),d.Gc(23,Vt,2,0,"mat-error",16),d.Wb(),d.Wb(),d.Xb(24,"div",12),d.Xb(25,"mat-form-field"),d.Xb(26,"mat-label"),d.Hc(27,"To Date"),d.Wb(),d.Sb(28,"input",17),d.Sb(29,"mat-datepicker-toggle",14),d.Sb(30,"mat-datepicker",null,18),d.Wb(),d.Wb(),d.Xb(32,"div",12),d.Xb(33,"button",19),d.fc("click",(function(){return d.Ac(i),d.xc(13).ngSubmit.emit()})),d.Hc(34,"Search"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Gc(35,Jt,27,5,"div",16),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=d.xc(13),r=d.xc(22),n=d.xc(31);d.Cb(12),d.oc("formGroup",t.expForm),d.Cb(7),d.oc("matDatepicker",r),d.Cb(1),d.oc("for",r),d.Cb(3),d.oc("ngIf",t.hasError("fromDate","required")),d.Cb(5),d.oc("matDatepicker",n),d.Cb(1),d.oc("for",n),d.Cb(4),d.oc("disabled",!a.form.valid),d.Cb(2),d.oc("ngIf",t.isSearched)}},directives:[n.e,g.a,o.p,o.l,o.f,W.c,W.f,X.b,o.a,I.b,o.k,o.d,I.d,W.g,I.a,r.l,W.b,r.k],pipes:[r.f],styles:[""]}),Kt),Zt=((Yt=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"save",value:function(e){return this.http.post("transaction/despatch",e)}},{key:"findAll",value:function(){return this.http.get("transaction/despatches")}},{key:"findById",value:function(e){return this.http.get("transaction/despatch/find",{params:{id:e}})}},{key:"delete",value:function(e){return this.http.delete("transaction/processes/delete",{params:{id:e.toString()}})}},{key:"deleteDetail",value:function(e,t){var i=new s.d;return i=(i=i.append("id",e)).append("detailId",t.toString()),this.http.delete("transaction/despatches/detail/delete",{params:i})}},{key:"findMaterialsByProjectIdAndSiteId",value:function(e,t){var i=new s.d;return i=(i=i.append("projectId",e)).append("siteId",t),this.http.get("transaction/despatches/materials",{params:i})}},{key:"findByProjectId",value:function(e){var t=new s.d;return t=t.append("projectId",e),this.http.get("transaction/despatches/project",{params:t})}}]),e}()).\u0275fac=function(e){return new(e||Yt)(d.bc(s.b))},Yt.\u0275prov=d.Nb({token:Yt,factory:Yt.\u0275fac,providedIn:"root"}),Yt);function ei(e,t){if(1&e&&(d.Xb(0,"mat-option",58),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.value),d.Cb(1),d.Jc(" ",i.viewValue," ")}}function ti(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Site Id is required"),d.Wb())}function ii(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Despatch date is required"),d.Wb())}function ai(e,t){if(1&e&&(d.Xb(0,"mat-option",58),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.projectId),d.Cb(1),d.Kc(" ",i.projectId," | ",i.description," ")}}function ri(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Project is required"),d.Wb())}function ni(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Vehicle no is required"),d.Wb())}function oi(e,t){if(1&e){var i=d.Yb();d.Xb(0,"tbody"),d.Xb(1,"tr"),d.Xb(2,"td"),d.Hc(3),d.Wb(),d.Xb(4,"td"),d.Hc(5),d.Wb(),d.Xb(6,"td"),d.Hc(7),d.Wb(),d.Xb(8,"td"),d.Hc(9),d.Wb(),d.Xb(10,"td"),d.Xb(11,"a",59),d.fc("click",(function(){d.Ac(i);var e=t.$implicit,a=d.ic(),r=d.xc(75);return a.editDetail(e,r)})),d.Xb(12,"mat-icon",60),d.Hc(13,"edit"),d.Wb(),d.Wb(),d.Xb(14,"a",61),d.fc("click",(function(){d.Ac(i);var e=t.$implicit;return d.ic().openDialog(e)})),d.Xb(15,"mat-icon",60),d.Hc(16,"delete"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=t.$implicit;d.Cb(3),d.Ic(a.materialName),d.Cb(2),d.Kc("",a.availableQuantity," ",a.materialUnitName,""),d.Cb(2),d.Kc("",a.quantity," ",a.materialUnitName,""),d.Cb(2),d.Ic(a.processType)}}function ci(e,t){if(1&e&&(d.Xb(0,"mat-option",58),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.code),d.Cb(1),d.Jc(" ",i.name," ")}}function li(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Material is required"),d.Wb())}function di(e,t){if(1&e){var i=d.Yb();d.Xb(0,"div",13),d.Xb(1,"mat-form-field",16),d.Xb(2,"input",62),d.fc("ngModelChange",(function(e){return d.Ac(i),d.ic().availableQuantity=e})),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=d.ic();d.Cb(2),d.oc("readonly",!0)("ngModel",a.availableQuantity)}}function si(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Quantity is required"),d.Wb())}function bi(e,t){1&e&&d.Sb(0,"mat-error")}function ui(e,t){if(1&e&&(d.Xb(0,"div",13),d.Xb(1,"mat-form-field",16),d.Sb(2,"input",63),d.Gc(3,si,2,0,"mat-error",19),d.Gc(4,bi,1,0,"mat-error",19),d.Wb(),d.Wb()),2&e){var i=d.ic();d.Cb(3),d.oc("ngIf",i.hasDetailError("quantity","required")),d.Cb(1),d.oc("ngIf",i.hasDetailError("quantity","mandatoryAndlessThanValue"))}}function mi(e,t){if(1&e&&(d.Xb(0,"mat-option",58),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.value),d.Cb(1),d.Jc(" ",i.viewValue," ")}}function fi(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Field value is required"),d.Wb())}function pi(e,t){if(1&e&&(d.Xb(0,"div",13),d.Xb(1,"mat-form-field",16),d.Xb(2,"mat-select",64),d.Gc(3,mi,2,2,"mat-option",18),d.Wb(),d.Gc(4,fi,2,0,"mat-error",19),d.Wb(),d.Wb()),2&e){var i=d.ic();d.Cb(3),d.oc("ngForOf",i.inOutValues),d.Cb(1),d.oc("ngIf",i.hasDetailError("processType","required"))}}function hi(e,t){if(1&e){var i=d.Yb();d.Xb(0,"div",13),d.Xb(1,"mat-form-field",16),d.Xb(2,"input",65),d.fc("ngModelChange",(function(e){return d.Ac(i),d.ic().despatchType=e})),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=d.ic();d.Cb(2),d.oc("readonly",!0)("ngModel",a.despatchType)}}var vi,gi=((vi=function(){function e(t,i,a,r,n,o,c){var l=this;_classCallCheck(this,e),this.orderDespatchService=t,this.projectService=i,this.dialog=a,this.route=r,this.notificationService=n,this.fb=o,this.datePipe=c,this.details=[],this.projects=[],this.projectMaterialList=[],this.workUnits=[{value:"DUMDUM",viewValue:"Dum dum unit"},{value:"SINGUR",viewValue:"Singur Unit"}],this.inOutValues=[{value:"IN",viewValue:"In"},{value:"OUT",viewValue:"Out"}],this.hasError=function(e,t){return l.odForm.controls[e].hasError(t)},this.hasDetailError=function(e,t){return l.odDetailsForm.controls[e].hasError(t)}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.getProjects(),this.odForm=this.fb.group({despatchId:new o.c(null),projectId:new o.c("",o.o.required),despatchDate:new o.c(null,o.o.required),despatchDateString:new o.c(""),notes:new o.c(""),siteId:new o.c(""),vehicleNo:new o.c(""),details:new o.c("")}),this.odDetailsForm=this.fb.group({despatchId:new o.c(""),despatchDetailsId:new o.c(""),despatchType:new o.c("",o.o.required),materialId:new o.c("",o.o.required),materialName:new o.c(""),materialUnit:new o.c("",o.o.required),materialUnitName:new o.c(""),quantity:new o.c(null,o.o.required),availableQuantity:new o.c(0),materialType:new o.c(""),remainingQuantity:new o.c(0)},{validator:[function(e){var t=e.controls.quantity,i=e.controls.availableQuantity,a=t.value<=i.value;return!a&&t.valid&&i.valid?(t.setErrors({lessThanValue:"quantity"}),{lessThanValue:"quantity should be less than availableQuantity"}):(a&&t.hasError("lessThanValue")&&t.setErrors(null),null)}]}),this.route.queryParams.subscribe((function(t){Object.keys(t).length>0&&e.orderDespatchService.findById(t.id).subscribe((function(t){e.details=t.details,t.despatchDate=Object(Oe.a)(t.despatchDateString),e.odForm.setValue(t),e.orderDespatchService.findMaterialsByProjectIdAndSiteId(t.projectId,t.siteId).subscribe((function(t){e.projectMaterialList=t}))}))}))}},{key:"onSubmit",value:function(){var e=this;this.odForm.valid&&(this.orderDespatch=this.odForm.value,this.orderDespatch.details=this.details,null!=this.odForm.value.despatchDate&&(this.orderDespatch.despatchDateString=this.datePipe.transform(this.orderDespatch.despatchDate,"dd/MM/yyyy")),this.orderDespatchService.save(this.orderDespatch).subscribe((function(t){e.notificationService.openSnackBar(t.message,t.status),console.log("success response ::"),console.log(t),e.odForm.reset(),e.details=[]}),(function(t){e.notificationService.openSnackBar(t.error.message,t.error.status),console.log("error response ::"),console.log(t.message)})))}},{key:"onDetailSubmit",value:function(e){if(this.odDetailsForm.valid){var t,i=this.odDetailsForm.value,a=i.despatchId;t=this.details.findIndex(null!=a?function(e){return e.despatchId==a}:function(e){return e.materialId==i.materialId}),console.log("last index >>"+t),-1!=t?(this.details[t]=this.odDetailsForm.value,this.notificationService.openSnackBar("Details updated successfully","success")):(this.details.push(this.odDetailsForm.value),this.notificationService.openSnackBar("Details added successfully","success")),this.odDetailsForm.reset(),e.hide()}else this.notificationService.openSnackBar("Error occurred, please review and submit again","danger")}},{key:"close",value:function(e){this.odDetailsForm.reset(),e.hide()}},{key:"editDetail",value:function(e,t){this.odDetailsForm.setValue(e),this.availableQuantity=e.availableQuantity,t.show()}},{key:"openDialog",value:function(e){var t=this;this.dialog.open(l.a,{width:"250px",data:{header:"Confirm",content:"Are you sure to delete?"}}).afterClosed().subscribe((function(i){i&&t.deleteDetail(e)}))}},{key:"deleteDetail",value:function(e){var t=this,i=this.calculateDetailIndex(e);e.despatchDetailsId?this.orderDespatchService.deleteDetail(e.despatchId,e.despatchDetailsId).subscribe((function(e){t.details.splice(i,1),t.notificationService.openSnackBar(e.message,e.status)}),(function(e){t.notificationService.openSnackBar(e.error.message,e.error.status),console.log("error response ::"),console.log(e.message)})):-1!==i&&(this.details.splice(i,1),this.notificationService.openSnackBar("Details removed successfully","success"))}},{key:"calculateDetailIndex",value:function(e){return this.details.findIndex(null!=e.despatchDetailsId?function(t){return t.despatchDetailsId==e.despatchDetailsId}:function(t){return t.materialId==e.materialId})}},{key:"getProjects",value:function(){var e=this;this.projectService.findAll().subscribe((function(t){e.projects=t}))}},{key:"populatDetailLists",value:function(e){var t=this;this.orderDespatchService.findMaterialsByProjectIdAndSiteId(e.value,this.siteId).subscribe((function(e){t.projectMaterialList=e}))}},{key:"populateRow",value:function(e){var t=e.value,i=this.projectMaterialList.filter((function(e){return e.code==t}))[0];this.materialId=i.code,this.materialName=i.name,this.materialType=i.type,this.materialUnit=i.unitId,this.materialUnitName=i.unitName,this.availableQuantity=i.availableQuantity,this.despatchType="OUT"}},{key:"isProduct",value:function(e){return"P"==e}},{key:"isSemiProduct",value:function(e){return"S"==e}},{key:"isProductMat",value:function(e){return"P"==e.materialType}},{key:"isMobileMenu",value:function(){return!($(window).width()>991)}},{key:"modalWIdth",value:function(){return this.isMobileMenu()?"100%":"150%"}}]),e}()).\u0275fac=function(e){return new(e||vi)(d.Rb(Zt),d.Rb(p.a),d.Rb(v.b),d.Rb(n.a),d.Rb(u.a),d.Rb(o.b),d.Rb(r.d))},vi.\u0275cmp=d.Lb({type:vi,selectors:[["app-order-despatch"]],decls:109,vars:26,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header","card-header-success"],[1,"card-title"],["routerLink","/transaction/despatch"],[1,"gridIcon"],[1,"card-category"],[1,"card-body"],[3,"formGroup","ngSubmit"],["headerForm","ngForm"],[1,"col-md-2"],[1,"invisible","example-full-width"],["matInput","","placeholder","despatchId","formControlName","despatchId"],[1,"example-full-width"],["placeholder","Work Unit","formControlName","siteId",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","formControlName","despatchDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker3",""],[1,"col-md-3"],["placeholder","Project","formControlName","projectId",3,"selectionChange"],["matInput","","placeholder","Vehicle No","formControlName","vehicleNo"],["matInput","","placeholder","Notes","formControlName","notes"],[1,"card","card-plain"],[1,"card-header","card-header-info"],["width","100%"],["width","90%"],[2,"align-content","justify-content-right"],["type","button","mdbBtn","","color","unique","rounded","true","data-toggle","modal","data-target","#basicExample","mdbWavesEffect","",3,"click"],[1,"table-responsive"],[1,"table","table-hover"],[1,"text-primary"],[4,"ngFor","ngForOf"],["mat-raised-button","","type","submit",1,"btn","btn-success","pull-right",3,"disabled","click"],[1,"clearfix"],["mdbModal","","id","frameModalTop","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade","left"],["frame","mdbModal"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","text-center"],[1,"modal-title","w-100","font-weight-bold"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[3,"formGroup"],[1,"col-md-4"],["matInput","","placeholder","despatchDetailsId","formControlName","despatchDetailsId"],["matInput","","placeholder","materialType","formControlName","materialType",3,"ngModel","ngModelChange"],["matInput","","placeholder","materialName","formControlName","materialName",3,"ngModel","ngModelChange"],["placeholder","Material","formControlName","materialId",3,"selectionChange"],["matInput","","placeholder","Unit","formControlName","materialUnit",3,"ngModel","ngModelChange"],["matInput","","placeholder","Unit","formControlName","materialUnitName",3,"readonly","ngModel","ngModelChange"],["class","col-md-2",4,"ngIf"],[1,"modal-footer","d-flex","justify-content-right"],["mdbBtn","","color","deep-orange","mdbWavesEffect","",1,"waves-light",3,"click"],[3,"value"],["title","","data-toggle","tooltip","data-original-title","Edit",1,"edit",2,"cursor","pointer",3,"click"],[1,"routeIcon"],["title","","data-toggle","tooltip","data-original-title","Delete",1,"delete",2,"cursor","pointer",3,"click"],["matInput","","placeholder","Available Quantity","formControlName","availableQuantity",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","Quantity","formControlName","quantity",2,"text-align","right"],["placeholder","In/Out","formControlName","processType"],["matInput","","placeholder","In/Out","formControlName","despatchType",3,"readonly","ngModel","ngModelChange"]],template:function(e,t){if(1&e){var i=d.Yb();d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Despatch "),d.Xb(8,"a",7),d.Xb(9,"mat-icon",8),d.Hc(10,"web"),d.Wb(),d.Wb(),d.Wb(),d.Xb(11,"p",9),d.Hc(12,"Record order despatch details here"),d.Wb(),d.Wb(),d.Xb(13,"div",10),d.Xb(14,"form",11,12),d.fc("ngSubmit",(function(){return t.onSubmit()})),d.Xb(16,"div",2),d.Xb(17,"div",13),d.Xb(18,"mat-form-field",14),d.Sb(19,"input",15),d.Wb(),d.Xb(20,"mat-form-field",16),d.Xb(21,"mat-select",17),d.fc("ngModelChange",(function(e){return t.siteId=e})),d.Gc(22,ei,2,2,"mat-option",18),d.Wb(),d.Gc(23,ti,2,0,"mat-error",19),d.Wb(),d.Wb(),d.Xb(24,"div",13),d.Xb(25,"mat-form-field"),d.Xb(26,"mat-label"),d.Hc(27,"Despatch Date"),d.Wb(),d.Sb(28,"input",20),d.Sb(29,"mat-datepicker-toggle",21),d.Sb(30,"mat-datepicker",null,22),d.Gc(32,ii,2,0,"mat-error",19),d.Wb(),d.Wb(),d.Xb(33,"div",23),d.Xb(34,"mat-form-field",16),d.Xb(35,"mat-select",24),d.fc("selectionChange",(function(e){return t.populatDetailLists(e)})),d.Gc(36,ai,2,3,"mat-option",18),d.Wb(),d.Gc(37,ri,2,0,"mat-error",19),d.Wb(),d.Wb(),d.Xb(38,"div",13),d.Xb(39,"mat-form-field"),d.Xb(40,"mat-label"),d.Hc(41,"Vehicle No"),d.Wb(),d.Sb(42,"input",25),d.Gc(43,ni,2,0,"mat-error",19),d.Wb(),d.Wb(),d.Xb(44,"div",23),d.Xb(45,"mat-form-field",16),d.Sb(46,"input",26),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(47,"div",2),d.Xb(48,"div",3),d.Xb(49,"div",27),d.Xb(50,"div",28),d.Xb(51,"table",29),d.Xb(52,"tr"),d.Xb(53,"td",30),d.Xb(54,"h4",6),d.Hc(55,"Daily work log Dteails"),d.Wb(),d.Wb(),d.Xb(56,"td",31),d.Xb(57,"button",32),d.fc("click",(function(){return d.Ac(i),d.xc(75).show()})),d.Hc(58," Add "),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Sb(59,"p",9),d.Wb(),d.Xb(60,"div",10),d.Xb(61,"div",33),d.Xb(62,"table",34),d.Xb(63,"thead",35),d.Xb(64,"th"),d.Hc(65,"Material"),d.Wb(),d.Xb(66,"th"),d.Hc(67,"Available Quantity"),d.Wb(),d.Xb(68,"th"),d.Hc(69,"Processed Quantity"),d.Wb(),d.Wb(),d.Gc(70,oi,17,6,"tbody",36),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(71,"button",37),d.fc("click",(function(){return d.Ac(i),d.xc(15).ngSubmit.emit()})),d.Hc(72,"Save"),d.Wb(),d.Sb(73,"div",38),d.Xb(74,"div",39,40),d.Xb(76,"div",41),d.Xb(77,"div",42),d.Xb(78,"div",43),d.Xb(79,"h4",44),d.Hc(80,"Add/Update Work Log"),d.Wb(),d.Xb(81,"button",45),d.fc("click",(function(){d.Ac(i);var e=d.xc(75);return t.close(e)})),d.Xb(82,"span",46),d.Hc(83,"\xd7"),d.Wb(),d.Wb(),d.Wb(),d.Xb(84,"div",10),d.Xb(85,"form",47),d.Xb(86,"div",2),d.Xb(87,"div",48),d.Xb(88,"mat-form-field",14),d.Sb(89,"input",15),d.Sb(90,"input",49),d.Xb(91,"input",50),d.fc("ngModelChange",(function(e){return t.materialType=e})),d.Wb(),d.Xb(92,"input",51),d.fc("ngModelChange",(function(e){return t.materialName=e})),d.Wb(),d.Wb(),d.Xb(93,"mat-form-field",16),d.Xb(94,"mat-select",52),d.fc("selectionChange",(function(e){return t.populateRow(e)})),d.Gc(95,ci,2,2,"mat-option",18),d.Wb(),d.Gc(96,li,2,0,"mat-error",19),d.Wb(),d.Wb(),d.Xb(97,"div",13),d.Xb(98,"mat-form-field",14),d.Xb(99,"input",53),d.fc("ngModelChange",(function(e){return t.materialUnit=e})),d.Wb(),d.Wb(),d.Xb(100,"mat-form-field",16),d.Xb(101,"input",54),d.fc("ngModelChange",(function(e){return t.materialUnitName=e})),d.Wb(),d.Wb(),d.Wb(),d.Gc(102,di,3,2,"div",55),d.Gc(103,ui,5,2,"div",55),d.Gc(104,pi,5,2,"div",55),d.Gc(105,hi,3,2,"div",55),d.Wb(),d.Xb(106,"div",56),d.Xb(107,"button",57),d.fc("click",(function(){d.Ac(i);var e=d.xc(75);return t.onDetailSubmit(e)})),d.Hc(108,"Save"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=d.xc(15),r=d.xc(31);d.Cb(14),d.oc("formGroup",t.odForm),d.Cb(7),d.oc("ngModel",t.siteId),d.Cb(1),d.oc("ngForOf",t.workUnits),d.Cb(1),d.oc("ngIf",t.hasError("siteId","required")),d.Cb(5),d.oc("matDatepicker",r),d.Cb(1),d.oc("for",r),d.Cb(3),d.oc("ngIf",t.hasError("despatchDate","required")),d.Cb(4),d.oc("ngForOf",t.projects),d.Cb(1),d.oc("ngIf",t.hasError("projectId","required")),d.Cb(6),d.oc("ngIf",t.hasError("vehicleNo","required")),d.Cb(27),d.oc("ngForOf",t.details),d.Cb(1),d.oc("disabled",!a.form.valid),d.Cb(6),d.Fc("width",t.modalWIdth()),d.Cb(8),d.oc("formGroup",t.odDetailsForm),d.Cb(6),d.oc("ngModel",t.materialType),d.Cb(1),d.oc("ngModel",t.materialName),d.Cb(3),d.oc("ngForOf",t.projectMaterialList),d.Cb(1),d.oc("ngIf",t.hasDetailError("materialId","required")),d.Cb(3),d.oc("ngModel",t.materialUnit),d.Cb(2),d.oc("readonly",!0)("ngModel",t.materialUnitName),d.Cb(1),d.oc("ngIf",t.isProduct(t.materialType)),d.Cb(1),d.oc("ngIf",t.isProduct(t.materialType)),d.Cb(1),d.oc("ngIf",t.isSemiProduct(t.materialType)),d.Cb(1),d.oc("ngIf",!t.isSemiProduct(t.materialType))}},directives:[n.e,g.a,o.p,o.l,o.f,W.c,X.b,o.a,o.k,o.d,y.a,r.k,r.l,W.f,I.b,I.d,W.g,I.a,C.b,C.c,D.l,W.b],styles:[""]}),vi);function Wi(e,t){if(1&e&&(d.Xb(0,"mat-option",20),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.projectId),d.Cb(1),d.Kc(" ",i.projectId," | ",i.description," ")}}var Xi=function(){return["/transaction/despatch/edit"]},yi=function(e){return{id:e}};function Ii(e,t){if(1&e&&(d.Xb(0,"tbody"),d.Xb(1,"tr"),d.Xb(2,"td"),d.Hc(3),d.Wb(),d.Xb(4,"td"),d.Hc(5),d.Wb(),d.Xb(6,"td"),d.Hc(7),d.Wb(),d.Xb(8,"td"),d.Hc(9),d.Wb(),d.Xb(10,"td"),d.Xb(11,"a",21),d.Xb(12,"mat-icon",22),d.Hc(13,"edit"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()),2&e){var i=t.$implicit;d.Cb(3),d.Ic(i.despatchId),d.Cb(2),d.Ic(i.despatchDateString),d.Cb(2),d.Ic(i.vehicleNo),d.Cb(2),d.Ic(i.notes),d.Cb(2),d.oc("routerLink",d.qc(6,Xi))("queryParams",d.rc(7,yi,i.despatchId))}}var Ci,Di,Si=((Ci=function(){function e(t,i,a,r,n,o,c){_classCallCheck(this,e),this.orderDespatchService=t,this.projectService=i,this.dialog=a,this.route=r,this.notificationService=n,this.fb=o,this.datePipe=c,this.despatches=[],this.projects=[]}return _createClass(e,[{key:"ngOnInit",value:function(){this.getProjects(),this.odForm=this.fb.group({projectId:new o.c("",o.o.required)})}},{key:"getProjects",value:function(){var e=this;this.projectService.findAll().subscribe((function(t){e.projects=t}))}},{key:"populatDetailLists",value:function(e){var t=this;this.orderDespatchService.findByProjectId(e.value).subscribe((function(e){t.despatches=e}))}},{key:"onSubmit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Ci)(d.Rb(Zt),d.Rb(p.a),d.Rb(v.b),d.Rb(n.a),d.Rb(u.a),d.Rb(o.b),d.Rb(r.d))},Ci.\u0275cmp=d.Lb({type:Ci,selectors:[["app-order-despatch-show"]],decls:32,vars:3,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card","card-plain"],[1,"card-header","card-header-info"],[1,"card-title"],["routerLink","/transaction/despatch/add"],[1,"gridIcon"],[1,"card-body"],[3,"formGroup","ngSubmit"],["headerForm","ngForm"],[1,"col-md-3"],[1,"example-full-width"],["placeholder","Project","formControlName","projectId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"table-responsive"],[1,"table","table-hover"],[1,"text-primary"],[4,"ngFor","ngForOf"],[3,"value"],["title","","data-toggle","tooltip","data-original-title","Edit",1,"edit",3,"routerLink","queryParams"],[1,"routeIcon"]],template:function(e,t){1&e&&(d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Order Despatch Log "),d.Xb(8,"a",7),d.Xb(9,"mat-icon",8),d.Hc(10,"add"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(11,"div",9),d.Xb(12,"form",10,11),d.fc("ngSubmit",(function(){return t.onSubmit()})),d.Xb(14,"div",2),d.Xb(15,"div",12),d.Xb(16,"mat-form-field",13),d.Xb(17,"mat-select",14),d.fc("selectionChange",(function(e){return t.populatDetailLists(e)})),d.Gc(18,Wi,2,3,"mat-option",15),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(19,"div",9),d.Xb(20,"div",16),d.Xb(21,"table",17),d.Xb(22,"thead",18),d.Xb(23,"th"),d.Hc(24,"Id"),d.Wb(),d.Xb(25,"th"),d.Hc(26,"Date"),d.Wb(),d.Xb(27,"th"),d.Hc(28,"Vehicle No"),d.Wb(),d.Xb(29,"th"),d.Hc(30,"Notes"),d.Wb(),d.Wb(),d.Gc(31,Ii,14,9,"tbody",19),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()),2&e&&(d.Cb(12),d.oc("formGroup",t.odForm),d.Cb(6),d.oc("ngForOf",t.projects),d.Cb(13),d.oc("ngForOf",t.despatches))},directives:[n.e,g.a,o.p,o.l,o.f,W.c,y.a,o.k,o.d,r.k,D.l],styles:[""]}),Ci),ki=function e(){_classCallCheck(this,e),this.details=[]},wi=((Di=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"save",value:function(e){return this.http.post("transaction/invoice",e)}},{key:"findAll",value:function(){return this.http.get("transaction/invoices")}},{key:"findById",value:function(e){return this.http.get("transaction/invoice/find",{params:{id:e}})}},{key:"delete",value:function(e){return this.http.delete("transaction/invoices/delete",{params:{id:e.toString()}})}},{key:"deleteDetail",value:function(e,t){var i=new s.d;return i=(i=i.append("id",e)).append("detailId",t.toString()),this.http.delete("transaction/invoices/detail/delete",{params:i})}},{key:"findMaterialsByProjectIdAndSiteId",value:function(e){var t=new s.d;return t=t.append("projectId",e),this.http.get("transaction/invoice/products",{params:t})}},{key:"findByProjectId",value:function(e){var t=new s.d;return t=t.append("projectId",e),this.http.get("transaction/invoices/project",{params:t})}}]),e}()).\u0275fac=function(e){return new(e||Di)(d.bc(s.b))},Di.\u0275prov=d.Nb({token:Di,factory:Di.\u0275fac,providedIn:"root"}),Di);function Mi(e,t){if(1&e&&(d.Xb(0,"div"),d.Xb(1,"p",6),d.Hc(2),d.Wb(),d.Wb()),2&e){var i=d.ic();d.Cb(2),d.Jc("Invoice Id : ",i.invoiceId,"")}}function Fi(e,t){1&e&&(d.Xb(0,"div"),d.Xb(1,"p",38),d.Hc(2,"Create new invoice"),d.Wb(),d.Wb())}function Hi(e,t){if(1&e&&(d.Xb(0,"mat-option",66),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.projectId),d.Cb(1),d.Kc(" ",i.projectId," | ",i.description," ")}}function Ni(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Project is required"),d.Wb())}function xi(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Invoice date is required"),d.Wb())}function Ai(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Vehicle no is required"),d.Wb())}function ji(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Amount is required "),d.Wb())}function qi(e,t){if(1&e){var i=d.Yb();d.Xb(0,"tbody"),d.Xb(1,"tr"),d.Xb(2,"td"),d.Hc(3),d.Wb(),d.Xb(4,"td"),d.Hc(5),d.Wb(),d.Xb(6,"td"),d.Hc(7),d.Wb(),d.Xb(8,"td"),d.Hc(9),d.Wb(),d.Xb(10,"td"),d.Xb(11,"a",67),d.fc("click",(function(){d.Ac(i);var e=t.$implicit,a=d.ic(),r=d.xc(90);return a.editDetail(e,r)})),d.Xb(12,"mat-icon",68),d.Hc(13,"edit"),d.Wb(),d.Wb(),d.Xb(14,"a",69),d.fc("click",(function(){d.Ac(i);var e=t.$implicit;return d.ic().openDialog(e)})),d.Xb(15,"mat-icon",68),d.Hc(16,"delete"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=t.$implicit;d.Cb(3),d.Ic(a.materialName),d.Cb(2),d.Kc("",a.quantity," ",a.materialUnitName,""),d.Cb(2),d.Ic(a.rate),d.Cb(2),d.Ic(a.amount)}}function Gi(e,t){if(1&e&&(d.Xb(0,"mat-option",66),d.Hc(1),d.Wb()),2&e){var i=t.$implicit;d.oc("value",i.code),d.Cb(1),d.Jc(" ",i.name," ")}}function Oi(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Material is required"),d.Wb())}function Pi(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Quantity is required"),d.Wb())}function Ei(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Rate is required"),d.Wb())}function Ri(e,t){1&e&&(d.Xb(0,"mat-error"),d.Hc(1,"Amount is required"),d.Wb())}var Ti,Ui=((Ti=function(){function e(t,i,a,r,n,o,c,l){var d=this;_classCallCheck(this,e),this.invoiceService=t,this.projectService=i,this.notificationService=a,this.dialog=r,this.route=n,this.fb=o,this.datePipe=c,this.rawMaterialService=l,this.details=[],this.inv=new ki,this.rawMaterials=[],this.filteredRawMaterialIds=[],this.filteredRawMaterials=[],this.projects=[],this.isActive=!0,this.projectMaterialList=[],this.paymentStatusValues=[{value:!0,viewValue:"Yes"},{value:!1,viewValue:"No"}],this.hasError=function(e,t){return d.invoiceForm.controls[e].hasError(t)},this.hasDetailError=function(e,t){return d.invoiceDetailsForm.controls[e].hasError(t)}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.getProjects(),this.invoiceForm=new o.e({invoiceId:new o.c(""),invoiceDate:new o.c(null,o.o.required),invoiceDateString:new o.c(""),projectId:new o.c("",o.o.required),vehicleNo:new o.c("",o.o.required),amount:new o.c(null),freightCharges:new o.c(null),cgstAmount:new o.c(null),sgstAmount:new o.c(null),totalAmount:new o.c(null),notes:new o.c(""),clientId:new o.c(""),details:new o.c("")}),this.invoiceDetailsForm=new o.e({invoiceId:new o.c(""),invoiceDetailsId:new o.c(""),materialId:new o.c("",o.o.required),materialName:new o.c(""),materialUnit:new o.c(""),materialUnitName:new o.c("",o.o.required),quantity:new o.c(0,o.o.required),rate:new o.c(0,o.o.required),amount:new o.c(0,o.o.required),availableQuantity:new o.c(null)}),this.route.queryParams.subscribe((function(t){Object.keys(t).length>0&&e.invoiceService.findById(t.id).subscribe((function(t){e.details=t.details,t.invoiceDate=Object(Oe.a)(t.invoiceDateString),e.invoiceForm.setValue(t),e.invoiceId=t.invoiceId,e.populateDetails(t.projectId)}))}))}},{key:"onSubmit",value:function(){var e=this;this.invoiceForm.valid&&(this.invoice=this.invoiceForm.value,this.invoice.details=this.details,null!=this.invoiceForm.value.invoiceDate&&(this.invoice.invoiceDateString=this.datePipe.transform(this.invoice.invoiceDate,"dd/MM/yyyy")),this.invoiceService.save(this.invoice).subscribe((function(t){e.notificationService.openSnackBar(t.message,t.status),console.log("success response ::"),console.log(t),e.invoiceForm.reset(),e.details=[]}),(function(t){e.notificationService.openSnackBar(t.error.message,t.error.status),console.log("error response ::"),console.log(t.message)})))}},{key:"onDetailSubmit",value:function(e){if(this.invoiceDetailsForm.valid){var t,i=this.invoiceDetailsForm.value,a=i.invoiceDetailsId;t=this.details.findIndex(null!=a?function(e){return e.invoiceDetailsId==a}:function(e){return e.materialId==i.materialId}),console.log("last index >>"+t),-1!=t?(this.details[t]=this.invoiceDetailsForm.value,this.notificationService.openSnackBar("Order details updated successfully","success")):(this.details.push(this.invoiceDetailsForm.value),this.notificationService.openSnackBar("Order details added successfully","success")),this.invoiceDetailsForm.reset(),this.headerAmount=this.calculateTotalDetailAmount(),this.calculate(this.headerAmount),e.hide()}else this.notificationService.openSnackBar("Error occurred, please review and submit again","danger")}},{key:"close",value:function(e){e.hide()}},{key:"editDetail",value:function(e,t){var i=this.projectMaterialList.filter((function(t){return t.code==e.materialId}))[0];this.availableQuantity=i.availableQuantity,this.invoiceDetailsForm.patchValue(e),t.show()}},{key:"openDialog",value:function(e){var t=this;this.dialog.open(l.a,{width:"250px",data:{header:"Confirm",content:"Are you sure to delete?"}}).afterClosed().subscribe((function(i){i&&t.deleteDetail(e)}))}},{key:"deleteDetail",value:function(e){var t=this,i=this.calculateDetailIndex(e);e.invoiceDetailsId?this.invoiceService.deleteDetail(e.invoiceId,e.invoiceDetailsId).subscribe((function(e){t.details.splice(i,1),t.headerAmount=t.calculateTotalDetailAmount(),t.calculate(t.headerAmount),t.notificationService.openSnackBar(e.message,e.status)}),(function(e){t.notificationService.openSnackBar(e.error.message,e.error.status),console.log("error response ::"),console.log(e.message)})):-1!==i&&(this.details.splice(i,1),this.headerAmount=this.calculateTotalDetailAmount(),this.calculate(this.headerAmount),this.notificationService.openSnackBar("Invoice details removed successfully","success"))}},{key:"calculateDetailIndex",value:function(e){return this.details.findIndex(null!=e.invoiceDetailsId?function(t){return t.invoiceDetailsId==e.invoiceDetailsId}:function(t){return t.materialId==e.materialId})}},{key:"calculateTotalDetailAmount",value:function(){var e=this.details.map((function(e){return e.amount})).reduce((function(e,t){return Number.parseFloat(e.toString())+Number.parseFloat(t.toString())}),0);return Number.parseFloat(e.toString()).toFixed(2)}},{key:"calculateHeader",value:function(){this.calculate(this.invoiceForm.value.amount)}},{key:"calculate",value:function(e){var t=this.invoiceForm.value.freightCharges,i=0;Object(c.a)(e)&&(i+=Number.parseFloat(e.toString())),Object(c.a)(t)&&(i+=Number.parseFloat(t.toString())),this.cgstAmount=(9*i/100).toFixed(2),this.sgstAmount=(9*i/100).toFixed(2),this.totalAmount=(i+Number.parseFloat(this.cgstAmount)+Number.parseFloat(this.sgstAmount)).toFixed(2)}},{key:"getProjects",value:function(){var e=this;this.projectService.findAll().subscribe((function(t){e.projects=t}))}},{key:"populatDetailLists",value:function(e){var t=e.value,i=this.projects.filter((function(e){return e.projectId==t}))[0];this.clientId=i.customerId,this.populateDetails(t),this.invoiceDetailsForm.reset()}},{key:"populateDetails",value:function(e){var t=this;this.invoiceService.findMaterialsByProjectIdAndSiteId(e).subscribe((function(e){t.projectMaterialList=e}))}},{key:"populateRow",value:function(e){var t=e.value,i=this.projectMaterialList.filter((function(e){return e.code==t}))[0];this.materialId=i.code,this.materialName=i.name,this.materialType=i.type,this.materialUnit=i.unitId,this.materialUnitName=i.unitName,this.availableQuantity=i.availableQuantity,this.rate=i.rate}},{key:"calculateDetail",value:function(){var e=this.invoiceDetailsForm.value.quantity,t=this.invoiceDetailsForm.value.rate;Object(c.a)(e)&&Object(c.a)(t)&&(this.amount=(Number.parseFloat(t.toString())*Number.parseFloat(e.toString())).toFixed(2))}},{key:"isMobileMenu",value:function(){return!($(window).width()>991)}},{key:"modalWIdth",value:function(){return this.isMobileMenu()?"100%":"150%"}}]),e}()).\u0275fac=function(e){return new(e||Ti)(d.Rb(wi),d.Rb(p.a),d.Rb(u.a),d.Rb(v.b),d.Rb(n.a),d.Rb(o.b),d.Rb(r.d),d.Rb(m.a))},Ti.\u0275cmp=d.Lb({type:Ti,selectors:[["app-invoice"]],decls:134,vars:38,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header","card-header-success"],[1,"card-title"],["routerLink","/transaction/invoices"],[1,"gridIcon"],[4,"ngIf"],[1,"card-body"],[3,"formGroup","ngSubmit"],["headerForm","ngForm"],[1,"col-md-3"],[1,"invisible","example-full-width"],["matInput","","placeholder","invoiceId","formControlName","invoiceId"],["matInput","","placeholder","clientId","formControlName","clientId",3,"ngModel","ngModelChange"],[1,"example-full-width"],["placeholder","Project","formControlName","projectId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-2"],["matInput","","formControlName","invoiceDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker3",""],["matInput","","placeholder","Vehicle No","formControlName","vehicleNo"],[1,"col-md-5"],["matInput","","placeholder","Notes","formControlName","notes"],["matInput","","placeholder","Amount","formControlName","amount",2,"text-align","right",3,"ngModel","readonly","ngModelChange","change"],["matInput","","placeholder","Freight Charges","formControlName","freightCharges",2,"text-align","right",3,"change"],["matInput","","placeholder","CGST","formControlName","cgstAmount",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","SGST","formControlName","sgstAmount",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","Total Amount","formControlName","totalAmount",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],[1,"card","card-plain"],[1,"card-header","card-header-info"],["width","100%"],["width","90%"],[2,"align-content","justify-content-right"],["type","button","mdbBtn","","color","unique","rounded","true","data-toggle","modal","data-target","#basicExample","mdbWavesEffect","",3,"click"],[1,"card-category"],[1,"table-responsive"],[1,"table","table-hover"],[1,"text-primary"],[4,"ngFor","ngForOf"],["mat-raised-button","","type","submit",1,"btn","btn-success","pull-right",3,"disabled","click"],[1,"clearfix"],["mdbModal","","id","frameModalTop","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade","left"],["frame","mdbModal"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","text-center"],[1,"modal-title","w-100","font-weight-bold"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[3,"formGroup"],[1,"col-md-4"],["matInput","","placeholder","invoiceDetailsId","formControlName","invoiceDetailsId"],["matInput","","placeholder","materialName","formControlName","materialName",3,"ngModel","ngModelChange"],["placeholder","Material","formControlName","materialId",3,"selectionChange"],["matInput","","placeholder","Unit","formControlName","materialUnit",3,"ngModel","ngModelChange"],["matInput","","placeholder","Unit","formControlName","materialUnitName",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","Available Quantity","formControlName","availableQuantity",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],["matInput","","placeholder","Quantity","formControlName","quantity",2,"text-align","right",3,"change"],["matInput","","placeholder","Rate","formControlName","rate",2,"text-align","right",3,"ngModel","ngModelChange","change"],["matInput","","placeholder","Amount","formControlName","amount",2,"text-align","right",3,"readonly","ngModel","ngModelChange"],[1,"modal-footer","d-flex","justify-content-right"],["mdbBtn","","color","deep-orange","mdbWavesEffect","",1,"waves-light",3,"click"],[3,"value"],["title","","data-toggle","tooltip","data-original-title","Edit",1,"edit",2,"cursor","pointer",3,"click"],[1,"routeIcon"],["title","","data-toggle","tooltip","data-original-title","Delete",1,"delete",2,"cursor","pointer",3,"click"]],template:function(e,t){if(1&e){var i=d.Yb();d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Invoice Generation "),d.Xb(8,"a",7),d.Xb(9,"mat-icon",8),d.Hc(10,"web"),d.Wb(),d.Wb(),d.Wb(),d.Gc(11,Mi,3,1,"div",9),d.Gc(12,Fi,3,0,"div",9),d.Wb(),d.Xb(13,"div",10),d.Xb(14,"form",11,12),d.fc("ngSubmit",(function(){return t.onSubmit()})),d.Xb(16,"div",2),d.Xb(17,"div",13),d.Xb(18,"mat-form-field",14),d.Sb(19,"input",15),d.Xb(20,"input",16),d.fc("ngModelChange",(function(e){return t.clientId=e})),d.Wb(),d.Wb(),d.Xb(21,"mat-form-field",17),d.Xb(22,"mat-select",18),d.fc("selectionChange",(function(e){return t.populatDetailLists(e)})),d.Gc(23,Hi,2,3,"mat-option",19),d.Wb(),d.Gc(24,Ni,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(25,"div",20),d.Xb(26,"mat-form-field"),d.Xb(27,"mat-label"),d.Hc(28,"Invoice Date"),d.Wb(),d.Sb(29,"input",21),d.Sb(30,"mat-datepicker-toggle",22),d.Sb(31,"mat-datepicker",null,23),d.Gc(33,xi,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(34,"div",20),d.Xb(35,"mat-form-field"),d.Xb(36,"mat-label"),d.Hc(37,"Vehicle No"),d.Wb(),d.Sb(38,"input",24),d.Gc(39,Ai,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(40,"div",25),d.Xb(41,"mat-form-field",17),d.Sb(42,"input",26),d.Wb(),d.Wb(),d.Wb(),d.Xb(43,"div",2),d.Xb(44,"div",20),d.Xb(45,"mat-form-field",17),d.Xb(46,"input",27),d.fc("ngModelChange",(function(e){return t.headerAmount=e}))("change",(function(){return t.calculateHeader()})),d.Wb(),d.Gc(47,ji,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(48,"div",20),d.Xb(49,"mat-form-field",17),d.Xb(50,"input",28),d.fc("change",(function(){return t.calculateHeader()})),d.Wb(),d.Wb(),d.Wb(),d.Xb(51,"div",20),d.Xb(52,"mat-form-field",17),d.Xb(53,"input",29),d.fc("ngModelChange",(function(e){return t.cgstAmount=e})),d.Wb(),d.Wb(),d.Wb(),d.Xb(54,"div",20),d.Xb(55,"mat-form-field",17),d.Xb(56,"input",30),d.fc("ngModelChange",(function(e){return t.sgstAmount=e})),d.Wb(),d.Wb(),d.Wb(),d.Xb(57,"div",20),d.Xb(58,"mat-form-field",17),d.Xb(59,"input",31),d.fc("ngModelChange",(function(e){return t.totalAmount=e})),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(60,"div",2),d.Xb(61,"div",3),d.Xb(62,"div",32),d.Xb(63,"div",33),d.Xb(64,"table",34),d.Xb(65,"tr"),d.Xb(66,"td",35),d.Xb(67,"h4",6),d.Hc(68,"Invoice Dteails"),d.Wb(),d.Wb(),d.Xb(69,"td",36),d.Xb(70,"button",37),d.fc("click",(function(){return d.Ac(i),d.xc(90).show()})),d.Hc(71," Add "),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Sb(72,"p",38),d.Wb(),d.Xb(73,"div",10),d.Xb(74,"div",39),d.Xb(75,"table",40),d.Xb(76,"thead",41),d.Xb(77,"th"),d.Hc(78,"Material"),d.Wb(),d.Xb(79,"th"),d.Hc(80,"Quantity"),d.Wb(),d.Xb(81,"th"),d.Hc(82,"Rate"),d.Wb(),d.Xb(83,"th"),d.Hc(84,"Amount"),d.Wb(),d.Wb(),d.Gc(85,qi,17,5,"tbody",42),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Xb(86,"button",43),d.fc("click",(function(){return d.Ac(i),d.xc(15).ngSubmit.emit()})),d.Hc(87,"Save"),d.Wb(),d.Sb(88,"div",44),d.Xb(89,"div",45,46),d.Xb(91,"div",47),d.Xb(92,"div",48),d.Xb(93,"div",49),d.Xb(94,"h4",50),d.Hc(95,"Add/Update Work Log"),d.Wb(),d.Xb(96,"button",51),d.fc("click",(function(){d.Ac(i);var e=d.xc(90);return t.close(e)})),d.Xb(97,"span",52),d.Hc(98,"\xd7"),d.Wb(),d.Wb(),d.Wb(),d.Xb(99,"div",10),d.Xb(100,"form",53),d.Xb(101,"div",2),d.Xb(102,"div",54),d.Xb(103,"mat-form-field",14),d.Sb(104,"input",15),d.Sb(105,"input",55),d.Xb(106,"input",56),d.fc("ngModelChange",(function(e){return t.materialName=e})),d.Wb(),d.Wb(),d.Xb(107,"mat-form-field",17),d.Xb(108,"mat-select",57),d.fc("selectionChange",(function(e){return t.populateRow(e)})),d.Gc(109,Gi,2,2,"mat-option",19),d.Wb(),d.Gc(110,Oi,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(111,"div",20),d.Xb(112,"mat-form-field",14),d.Xb(113,"input",58),d.fc("ngModelChange",(function(e){return t.materialUnit=e})),d.Wb(),d.Wb(),d.Xb(114,"mat-form-field",17),d.Xb(115,"input",59),d.fc("ngModelChange",(function(e){return t.materialUnitName=e})),d.Wb(),d.Wb(),d.Wb(),d.Xb(116,"div",20),d.Xb(117,"mat-form-field",17),d.Xb(118,"input",60),d.fc("ngModelChange",(function(e){return t.availableQuantity=e})),d.Wb(),d.Wb(),d.Wb(),d.Xb(119,"div",20),d.Xb(120,"mat-form-field",17),d.Xb(121,"input",61),d.fc("change",(function(){return t.calculateDetail()})),d.Wb(),d.Gc(122,Pi,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(123,"div",20),d.Xb(124,"mat-form-field",17),d.Xb(125,"input",62),d.fc("ngModelChange",(function(e){return t.rate=e}))("change",(function(){return t.calculateDetail()})),d.Wb(),d.Gc(126,Ei,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Xb(127,"div",20),d.Xb(128,"mat-form-field",17),d.Xb(129,"input",63),d.fc("ngModelChange",(function(e){return t.amount=e})),d.Wb(),d.Gc(130,Ri,2,0,"mat-error",9),d.Wb(),d.Wb(),d.Wb(),d.Xb(131,"div",64),d.Xb(132,"button",65),d.fc("click",(function(){d.Ac(i);var e=d.xc(90);return t.onDetailSubmit(e)})),d.Hc(133,"Save"),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()}if(2&e){var a=d.xc(15),r=d.xc(32);d.Cb(11),d.oc("ngIf",t.invoiceId),d.Cb(1),d.oc("ngIf",!t.invoiceId),d.Cb(2),d.oc("formGroup",t.invoiceForm),d.Cb(6),d.oc("ngModel",t.clientId),d.Cb(3),d.oc("ngForOf",t.projects),d.Cb(1),d.oc("ngIf",t.hasError("projectId","required")),d.Cb(5),d.oc("matDatepicker",r),d.Cb(1),d.oc("for",r),d.Cb(3),d.oc("ngIf",t.hasError("invoiceDate","required")),d.Cb(6),d.oc("ngIf",t.hasError("vehicleNo","required")),d.Cb(7),d.oc("ngModel",t.headerAmount)("readonly",!0),d.Cb(1),d.oc("ngIf",t.hasError("amount","required")),d.Cb(6),d.oc("readonly",!0)("ngModel",t.cgstAmount),d.Cb(3),d.oc("readonly",!0)("ngModel",t.sgstAmount),d.Cb(3),d.oc("readonly",!0)("ngModel",t.totalAmount),d.Cb(26),d.oc("ngForOf",t.details),d.Cb(1),d.oc("disabled",!a.form.valid),d.Cb(6),d.Fc("width",t.modalWIdth()),d.Cb(8),d.oc("formGroup",t.invoiceDetailsForm),d.Cb(6),d.oc("ngModel",t.materialName),d.Cb(3),d.oc("ngForOf",t.projectMaterialList),d.Cb(1),d.oc("ngIf",t.hasDetailError("materialId","required")),d.Cb(3),d.oc("ngModel",t.materialUnit),d.Cb(2),d.oc("readonly",!0)("ngModel",t.materialUnitName),d.Cb(3),d.oc("readonly",!0)("ngModel",t.availableQuantity),d.Cb(4),d.oc("ngIf",t.hasDetailError("quantity","required")),d.Cb(3),d.oc("ngModel",t.rate),d.Cb(1),d.oc("ngIf",t.hasDetailError("rate","required")),d.Cb(3),d.oc("readonly",!0)("ngModel",t.amount),d.Cb(1),d.oc("ngIf",t.hasDetailError("amount","required"))}},directives:[n.e,g.a,r.l,o.p,o.l,o.f,W.c,X.b,o.a,o.k,o.d,y.a,r.k,W.f,I.b,I.d,W.g,I.a,C.b,C.c,D.l,W.b],styles:[""]}),Ti),Bi=function(){return["/transaction/invoice/edit"]},Li=function(e){return{id:e}};function $i(e,t){if(1&e&&(d.Xb(0,"tr",17),d.Xb(1,"td"),d.Hc(2),d.Wb(),d.Xb(3,"td"),d.Hc(4),d.Wb(),d.Xb(5,"td"),d.Hc(6),d.Wb(),d.Xb(7,"td"),d.Hc(8),d.Wb(),d.Xb(9,"td"),d.Hc(10),d.Wb(),d.Xb(11,"td"),d.Xb(12,"a",18),d.Xb(13,"mat-icon",19),d.Hc(14,"edit"),d.Wb(),d.Wb(),d.Wb(),d.Wb()),2&e){var i=d.ic().$implicit;d.Cb(2),d.Ic(i.invoiceId),d.Cb(2),d.Ic(i.projectId),d.Cb(2),d.Ic(i.invoiceDateString),d.Cb(2),d.Ic(i.totalAmount),d.Cb(2),d.Ic(i.vehicleNo),d.Cb(2),d.oc("routerLink",d.qc(7,Bi))("queryParams",d.rc(8,Li,i.invoiceId))}}function Vi(e,t){if(1&e&&(d.Xb(0,"tr",20),d.Xb(1,"td"),d.Hc(2),d.Wb(),d.Xb(3,"td"),d.Hc(4),d.Wb(),d.Xb(5,"td"),d.Hc(6),d.Wb(),d.Xb(7,"td"),d.Hc(8),d.Wb(),d.Xb(9,"td"),d.Hc(10),d.Wb(),d.Xb(11,"td"),d.Xb(12,"a",18),d.Xb(13,"mat-icon",19),d.Hc(14,"edit"),d.Wb(),d.Wb(),d.Wb(),d.Wb()),2&e){var i=d.ic().$implicit;d.Cb(2),d.Ic(i.invoiceId),d.Cb(2),d.Ic(i.projectId),d.Cb(2),d.Ic(i.invoiceDateString),d.Cb(2),d.Ic(i.totalAmount),d.Cb(2),d.Ic(i.vehicleNo),d.Cb(2),d.oc("routerLink",d.qc(7,Bi))("queryParams",d.rc(8,Li,i.invoiceId))}}function Qi(e,t){if(1&e&&(d.Xb(0,"tbody"),d.Gc(1,$i,15,10,"tr",15),d.Gc(2,Vi,15,10,"tr",16),d.Wb()),2&e){var i=t.$implicit;d.Cb(1),d.oc("ngIf",i.isPaymentDone),d.Cb(1),d.oc("ngIf",!i.isPaymentDone)}}var _i,Ji,Yi,Ki=[{path:"order-placement/add",component:Q},{path:"orders/edit",component:Q},{path:"orders",component:ie},{path:"project/add",component:De},{path:"projects/edit",component:De},{path:"projects",component:je},{path:"order-delivery/add",component:it},{path:"deliveries",component:lt},{path:"order-delivery/edit",component:it},{path:"log/add",component:Ft},{path:"logs",component:Ot},{path:"log/edit",component:Ft},{path:"expense/add",component:$t},{path:"expenses",component:zt},{path:"despatch/add",component:gi},{path:"despatches",component:Si},{path:"despatch/edit",component:gi},{path:"invoice/add",component:Ui},{path:"invoice/edit",component:Ui},{path:"invoices",component:(_i=function(){function e(t,i,a){_classCallCheck(this,e),this.invoiceService=t,this.notificationService=i,this.dialog=a,this.invoices=[]}return _createClass(e,[{key:"ngOnInit",value:function(){this.findAll()}},{key:"findAll",value:function(){var e=this;this.invoiceService.findAll().subscribe((function(t){e.invoices=t}))}},{key:"delete",value:function(e){var t=this;this.invoiceService.delete(e.invoiceId).subscribe((function(e){console.log("Delete Response >>>>"),console.log(e),t.notificationService.openSnackBar(e.message,e.status),t.findAll()}))}},{key:"openDialog",value:function(e){var t=this;this.dialog.open(l.a,{width:"250px",data:{header:"Confirm",content:"Are you sure to delete?"}}).afterClosed().subscribe((function(i){i&&t.delete(e)}))}},{key:"isMobileMenu",value:function(){return!($(window).width()>991)}}]),e}(),_i.\u0275fac=function(e){return new(e||_i)(d.Rb(wi),d.Rb(u.a),d.Rb(v.b))},_i.\u0275cmp=d.Lb({type:_i,selectors:[["app-invoice-show"]],decls:29,vars:1,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card","card-plain"],[1,"card-header","card-header-info"],[1,"card-title"],["routerLink","/transaction/invoice/add"],[1,"gridIcon"],[1,"card-category"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-hover"],[1,"text-primary"],[4,"ngFor","ngForOf"],["class","table-success",4,"ngIf"],["class","table-danger",4,"ngIf"],[1,"table-success"],["title","","data-toggle","tooltip","data-original-title","Edit",1,"edit",3,"routerLink","queryParams"],[1,"routeIcon"],[1,"table-danger"]],template:function(e,t){1&e&&(d.Xb(0,"div",0),d.Xb(1,"div",1),d.Xb(2,"div",2),d.Xb(3,"div",3),d.Xb(4,"div",4),d.Xb(5,"div",5),d.Xb(6,"h4",6),d.Hc(7,"Invoice details "),d.Xb(8,"a",7),d.Xb(9,"mat-icon",8),d.Hc(10,"add"),d.Wb(),d.Wb(),d.Wb(),d.Sb(11,"p",9),d.Wb(),d.Xb(12,"div",10),d.Xb(13,"div",11),d.Xb(14,"table",12),d.Xb(15,"thead",13),d.Xb(16,"th"),d.Hc(17,"Invoice Id"),d.Wb(),d.Xb(18,"th"),d.Hc(19,"Project Id"),d.Wb(),d.Xb(20,"th"),d.Hc(21,"Invoice Date"),d.Wb(),d.Xb(22,"th"),d.Hc(23,"Total Amount"),d.Wb(),d.Xb(24,"th"),d.Hc(25,"Vehicle No"),d.Wb(),d.Xb(26,"th"),d.Hc(27,"Action"),d.Wb(),d.Wb(),d.Gc(28,Qi,3,2,"tbody",14),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb(),d.Wb()),2&e&&(d.Cb(28),d.oc("ngForOf",t.invoices))},directives:[n.e,g.a,r.k,r.l],styles:[""]}),_i)}],zi=((Ji=function e(){_classCallCheck(this,e)}).\u0275mod=d.Pb({type:Ji}),Ji.\u0275inj=d.Ob({factory:function(e){return new(e||Ji)},imports:[[n.f.forChild(Ki)],n.f]}),Ji),Zi=i("MutI"),ea=i("STbY"),ta=i("XhcP"),ia=i("dNgK"),aa=i("QibW"),ra=i("wZkO"),na=i("+0xr"),oa=i("A5z7"),ca=((Yi=function e(){_classCallCheck(this,e)}).\u0275mod=d.Pb({type:Yi}),Yi.\u0275inj=d.Ob({factory:function(e){return new(e||Yi)},imports:[[r.b,zi,Zi.b,ea.a,g.b,X.c,ta.b,s.c,o.n,o.g,ia.c,aa.a,y.b,ra.a,v.f,na.a,I.c,[C.d.forRoot()],C.f,C.e,C.a,D.j,D.q,oa.c]]}),Yi)}}]);